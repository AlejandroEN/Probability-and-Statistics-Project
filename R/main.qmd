---
title: "Entrega 1"
format: html
editor: visual
---

# [An치lisis de los casos de anemia en infantes y mujeres de 12 a 49 a침os en el Per칰 en el a침o 2022]{.underline}

## Introducci칩n

### Relevancia

La anemia representa un importante desaf칤o de salud p칰blica en nuestro pa칤s. La deficiencia de hemoglobina en la sangre puede acarrear graves consecuencias. Entre ellas, se incluye el potencial impacto negativo en el desarrollo f칤sico y cognitivo de los ni침os, as칤 como el aumento del riesgo de complicaciones durante el embarazo en las mujeres. Por tanto, resulta fundamental comprender tanto la prevalencia como la gravedad de la anemia en estos grupos de poblaci칩n para poder abordar de manera adecuada esta cuesti칩n de salud en nuestra naci칩n.

### Objetivos

-   Describir los casos de anemia y su severidad en ni침os y mujeres en el Per칰 en el a침o 2022.

-   Analizar el 칤ndice de anemia en las diversas regiones del Per칰 en el a침o 2022.

-   Describir las caracter칤sticas sociales de los grupos vulnerables (ni침os y mujeres) a la anemia en el Per칰 en el a침o 2022.

### Contexto

En el mes de mayo del a침o 2022, se llev칩 a cabo en nuestro pa칤s la Encuesta Demogr치fica y de Salud Familiar, un estudio que recopil칩 datos de una muestra representativa de viviendas en todo el territorio peruano. Este estudio se bas칩 en tres cuestionarios dise침ados para tres grupos: uno dirigido a todos los miembros de cada hogar, otro enfocado en mujeres cuyas edades se encontraban en el rango de 12 a 49 a침os, y un tercero destinado a individuos de 15 a침os o m치s.

En el contexto de esta encuesta, se solicit칩 a los residentes de los hogares su participaci칩n en una evaluaci칩n destinada a conocer sus niveles de hemoglobina en la sangre, a la que pod칤an optar por unirse o no.

La totalidad de la informaci칩n recopilada en esta encuesta se encuentra disponible para consulta por parte de cualquier ciudadano en la base de datos del Instituto Nacional de Estad칤stica e Inform치tica (INEI). Los datos se presentan organizados en m칩dulos tem치ticos, y el enfoque de nuestro inter칠s recae en aquel relacionado con la prevalencia de anemia.

### Planificaci칩n.

La forma en que nos organizamos en hacer este proyecto se puede visualizar en este diagrama de Gantt:

```{r warning=FALSE, echo=FALSE}

library(DiagrammeR)

mermaid("
gantt
dateFormat  YYYY-MM-DD
title Diagrama de Gantt

section Main things
Preparar PG01:first_1,2023-04-15, 3d
Entrega PG01:first_2,2023-04-18, 2d
Preparar PG02:first_3,2023-04-20, 11d
Entrega PG02:first_4,2023-05-01, 2d
Preparar PG03:first_5,2023-05-03, 21d
Entrega PG03:first_6,2023-05-24, 2d
Informe PG1:first_7,2023-05-26, 9d
Entrega Informe:first_8, 2023-06-04,1d

section PG01
Diagrama de Gantt:first_1, 2023-04-15, 12h
Delimitar tema:first_2, after first_1, 12h
Variables de analisis: first_3, after first_2, 6h
Limpieza de la base de datos: first_4, after first_2, 12h
Analizar la factibilidad: first_5, after first_3, 1d

section PG02
Replantear objetivos:first_6, 2023-04-20, 1d
Limpieza de tablas:first_7, after first_6, 5d
Correcci칩n de variables:first_8, after first_7, 5d

section PG03
An치lisis univariado:first_9, 2023-05-03, 12d
An치lisis bivariado:first_10, 2023-05-10, 10d
An치lisis multivariado:first_11, 2023-05-15, 7d
Escribir an치lisis:first_12, after first_11, 2d

section Informe PG1
Correcciones:first_13, 2023-05-26, 3d
Union de PG0x:first_14, after first_13, 2d
Verificar ortograf칤a:first_15, after first_14, 2d
Informe prolijo:first_16, after first_15, 2d
")
```

## Datos.

En esta secci칩n, detallaremos c칩mo se llevaron a cabo la recolecci칩n de datos, la definici칩n de la poblaci칩n y muestra, as칤 como la explicaci칩n de las variables de estudio. Adem치s, se proporcionar치 una visi칩n general de la limpieza de datos realizada.

### Recolecci칩n de datos.

Los datos para este estudio se obtuvieron a partir de la Encuesta Demogr치fica y de Salud Familiar realizada en mayo de 2022 en el Per칰.

Para nuestra investigaci칩n, accedimos a la base de datos del Instituto Nacional de Estad칤stica e Inform치tica (INEI) que conten칤a la informaci칩n recopilada en esta encuesta. Se seleccionaron m칩dulos espec칤ficos que eran relevantes para nuestro estudio sobre la anemia en ni침os y madres. Estos m칩dulos inclu칤an informaci칩n sobre las caracter칤sticas de los hogares y sus integrantes. El acceso a esta base de datos nos proporcion칩 una amplia cantidad de informaci칩n relevante y detallada para nuestros objetivos de investigaci칩n.

### Poblaci칩n, muestra y muestreo.

-   **Poblaci칩n:** Son los integrantes del total de viviendas obtenida de los Censos Nacionales 2017: XII de Poblaci칩n y VII de Vivienda y III de Comunidades Ind칤genas, en el que se registro que en el Per칰 hay un total de 10 millones 102 mil 849 viviendas particulares.

-   **Muestra:** Se tomaron 36650 del total de viviendas.

-   **Muestreo:** El muestreo ha sido probabil칤stico, por conglomerados.

### Variables

| Nombre   | Descripci칩n | Restricci칩n               | Tipo de variable |
|----------|-------------|---------------------------|------------------|
| Variable | Estrato     | Areas densamente pobladas | Tipo             |
| Variable | Estrato     | Areas densamente pobladas | Tipo             |
| Variable | Estrato     | Areas densamente pobladas | Tipo             |
| Variable | Estrato     | Areas densamente pobladas | Tipo             |
| variable | Estrato     | Areas densamente pobladas | Tipo             |

### Carga de librerias y datasets

Primero cargamos las librer칤as necesarias para trabajar

```{r message=FALSE}
library(readr)
library(dplyr)
library(ggplot2)
library(gt)
```

Cargamos tambi칠n los datasets.

```{r, message=FALSE}
REC91_raw <- read_csv("../data/raw_data/REC91.csv")
REC0111_raw <- read_csv("../data/raw_data/REC0111.csv")
RECH5_raw <- read_csv("../data/raw_data/RECH5.csv")
REC44_raw <- read_csv("../data/raw_data/REC44.csv")
RECH23_raw <- read_csv("../data/raw_data/RECH23.csv")
RECH0_raw <- read_csv("../data/raw_data/RECH0.csv")
```

### Resumen de datos y obtenci칩n de variables pertinentes

Realizaremos un resumen de los datos de cada tabla y, adem치s, comenzaremos con nuestro primer criterio de exclusi칩n: seleccionaremos solo las variables pertinentes para nuestro estudio.

#### Tabla RECH0 - Caracter칤sticas del hogar

```{r}
summary(RECH0_raw)
```

Seleccionamos las variables pertinentes en nuestro an치lisis, les cambiamos de nombres y, de ser necesario, cambiamos el tipo de dato.

```{r}
RECH0 <- select(RECH0_raw, HHID, HV009, HV015)

RECH0 <- rename(RECH0,
                cuestionario_hogar_id = HHID,
                personas_en_el_hogar = HV009,
                estado_entrevista = HV015)

RECH0$cuestionario_hogar_id <- as.character(RECH0$cuestionario_hogar_id)
RECH0$estado_entrevista <- as.character(RECH0$estado_entrevista)

str(RECH0)
```

#### Tabla REC0111 - Datos b치sicos del MEF

Relaci칩n entre identificaci칩n del cuestionario individual e identificaci칩n del cuestionario del hogar.

```{r}
summary(REC0111_raw)
```

Seleccionamos las variables pertinentes en nuestro an치lisis, les cambiamos de nombres y, de ser necesario, cambiamos el tipo de dato.

```{r}
REC0111 <- select(REC0111_raw, CASEID, HHID, V015, V024, V102)

REC0111 <- rename(REC0111,
                  cuestionario_individual_id = CASEID,
                  cuestionario_hogar_id = HHID,
                  estado_entrevista = V015,
                  region = V024,
                  tipo_de_residencia = V102)

REC0111$cuestionario_individual_id <- as.character(REC0111$cuestionario_individual_id)
REC0111$cuestionario_hogar_id <- as.character(REC0111$cuestionario_hogar_id)
REC0111$region <- as.character(REC0111$region)
REC0111$tipo_de_residencia <- as.character(REC0111$tipo_de_residencia)

region_names <- c("1" = "Amazonas", "2" = "Ancash", "3" = "Apurimac", "4" = "Arequipa", 
                  "5" = "Ayacucho", "6" = "Cajamarca", "7" = "Callao", "8" = "Cusco", 
                  "9" = "Huancavelica", "10" = "Huanuco", "11" = "Ica", "12" = "Junin",
                  "13" = "La Libertad", "14" = "Lambayeque", "15" = "Lima",
                  "16" = "Loreto", "17" = "Madre de Dios", "18" = "Moquegua",
                  "19" = "Pasco",  "20" =  "Piura",  "21"  =  "Puno",
                  "22"  =  "San Martin",  "23"  =  "Tacna",
                  "24"  =  "Tumbes",  "25"  =  "Ucayali")

REC0111$region <- region_names[as.character(REC0111$region)]

str(REC0111)
```

Asignamos la categor칤a que corresponde a cada n칰mero para la variable *tipo de residencia*.

```{r}
REC0111$tipo_de_residencia[REC0111$tipo_de_residencia %in% c(1)] <- "urbano"
REC0111$tipo_de_residencia[REC0111$tipo_de_residencia %in% c(2)] <- "rural"
```

#### Tabla RECH5 - Peso y talla (anemia)

Caracter칤sticas de las mujeres de 12 a 49 a침os.

```{r}
summary(RECH5_raw)
```

Seleccionamos las variables pertinentes en nuestro an치lisis, les cambiamos de nombres y, de ser necesario, cambiamos el tipo de dato.

```{r}
RECH5 <- select(RECH5_raw, HHID, HA1, HA2, HA3, HA13, HA53, HA54, HA55, HA56, HA57, HA66)

RECH5 <- rename(RECH5,
                cuestionario_individual_id = HHID,
                edad = HA1,
                peso = HA2,
                talla = HA3,
                estado_medicion = HA13,
                hemoglobina = HA53,
                is_embarazada = HA54,
                estado_medicion_hemoglobina = HA55,
                hemoglobina_ajustada_latitud = HA56,
                anemia = HA57,
                nivel_educativo = HA66)

RECH5$estado_medicion <- as.character(RECH5$estado_medicion)
RECH5$is_embarazada <- as.character(RECH5$is_embarazada)
RECH5$estado_medicion_hemoglobina <- as.character(RECH5$estado_medicion_hemoglobina)
RECH5$anemia <- as.character(RECH5$anemia)
RECH5$nivel_educativo <- as.character(RECH5$nivel_educativo)

str(RECH5)
```

Asignamos la categor칤a que corresponde a cada n칰mero para la variable *anemia*.

```{r}
RECH5$anemia[RECH5$anemia %in% c(1)] <- "grave"
RECH5$anemia[RECH5$anemia %in% c(2)] <- "moderado"
RECH5$anemia[RECH5$anemia %in% c(3)] <- "leve"
RECH5$anemia[RECH5$anemia %in% c(4)] <- "sin_anemia"
```

Asignamos la categor칤a que corresponde a cada n칰mero para la variable *nivel_educativo*.

```{r}
RECH5$nivel_educativo[RECH5$nivel_educativo %in% c(0)] <- "sin_educacion"
RECH5$nivel_educativo[RECH5$nivel_educativo %in% c(1)] <- "primaria"
RECH5$nivel_educativo[RECH5$nivel_educativo %in% c(2)] <- "secundaria"
RECH5$nivel_educativo[RECH5$nivel_educativo %in% c(3)] <- "superior"
RECH5$nivel_educativo[RECH5$nivel_educativo %in% c(8)] <- "no_sabe"
```

Cambiamos las unidades de *talla* y *peso*.

```{r}
RECH5 <- mutate(RECH5,
                # Convertimos de cent칤metros a metros
                talla = talla / 10,
                # Convertimos de gramos a kilogramos
                peso = peso / 10)
```

#### Tabla REC44 - Peso y talla (anemia)

Caracter칤sticas de los infantes de 0 a 59 meses (5 a침os aproximadamente) seleccionados por hogar.

```{r}
summary(REC44_raw)
```

Seleccionamos las variables pertinentes en nuestro an치lisis, les cambiamos de nombres y, de ser necesario, cambiamos el tipo de dato.

```{r}
REC44 <- select(REC44_raw, CASEID, HW1, HW2, HW3, HW13, HW53, HW55, HW56, HW57)

REC44 <- rename(REC44,
                cuestionario_individual_id = CASEID,
                edad = HW1,
                peso = HW2,
                talla = HW3,
                estado_medicion = HW13,
                hemoglobina = HW53,
                estado_medicion_hemoglobina = HW55,
                hemoglobina_ajustada_latitud = HW56,
                anemia = HW57)

REC44$estado_medicion <- as.character(REC44$estado_medicion)
REC44$estado_medicion_hemoglobina <- as.character(REC44$estado_medicion_hemoglobina)
REC44$anemia <- as.character(REC44$anemia)

str(REC44)
```

Asignamos la categor칤a que corresponde a cada n칰mero para la variable *anemia*.

```{r}
REC44$anemia[REC44$anemia %in% c(1)] <- "grave"
REC44$anemia[REC44$anemia %in% c(2)] <- "moderado"
REC44$anemia[REC44$anemia %in% c(3)] <- "leve"
REC44$anemia[REC44$anemia %in% c(4)] <- "sin_anemia"
```

Cambiamos las unidades de *talla* y *peso*.

```{r}
REC44 <- mutate(REC44,
                # Agregamos el decimal mencionado en el diccionario.
                talla = talla / 10,
                # Agregamos el decimal mencionado en el diccionario.
                peso = peso / 10)
```

#### Tabla RECH23 - Caracter칤sticas del hogar de los participantes

Estos contienen las caracter칤sticas del modo de vida de los que respondieron la encuesta.

```{r}
RECH23 <- select(RECH23_raw, HHID, HV201, HV205, HV206, HV226, SH70, HV270)

RECH23 <- rename(RECH23,
                cuestionario_hogar_id = HHID,
                fuente_agua = HV201,
                servicio_higienico = HV205,
                electricidad = HV206,
                combustible_cocina = HV226,
                alumbrado = SH70,
                indice_riqueza = HV270)
RECH23$cuestionario_hogar_id <- as.character(RECH23$cuestionario_hogar_id)
RECH23$fuente_agua <- as.character(RECH23$fuente_agua)
RECH23$servicio_higienico <- as.character(RECH23$servicio_higienico)
RECH23$electricidad <- as.character(RECH23$electricidad)
RECH23$combustible_cocina <- as.character(RECH23$combustible_cocina)
RECH23$alumbrado <- as.character(RECH23$alumbrado)
RECH23$indice_riqueza <- as.character(RECH23$indice_riqueza)
str(RECH23)
```

Asignamos la categor칤a que corresponde a cada n칰mero para la variable *fuente_agua*

```{r}
RECH23$fuente_agua[RECH23$fuente_agua %in% c(11)] <- "dentro_vivienda"
RECH23$fuente_agua[RECH23$fuente_agua %in% c(12)] <- "fuera_vivienda"
RECH23$fuente_agua[RECH23$fuente_agua %in% c(13)] <- "pilon/grifo_publico"
RECH23$fuente_agua[RECH23$fuente_agua %in% c(21)] <- "pozo_vivienda"
RECH23$fuente_agua[RECH23$fuente_agua %in% c(22)] <- "pozo_publico"
RECH23$fuente_agua[RECH23$fuente_agua %in% c(41)] <- "manantial"
RECH23$fuente_agua[RECH23$fuente_agua %in% c(43)] <- "rio/acequia/laguna"
RECH23$fuente_agua[RECH23$fuente_agua %in% c(51)] <- "agua_lluvia"
RECH23$fuente_agua[RECH23$fuente_agua %in% c(61)] <- "cisterna"
RECH23$fuente_agua[RECH23$fuente_agua %in% c(71)] <- "agua_embotellada"
RECH23$fuente_agua[RECH23$fuente_agua %in% c(96)] <- "otro"
```

Asignamos la categor칤a que corresponde a cada n칰mero para la variable *servicio_higienico*

```{r}
RECH23$servicio_higienico[RECH23$servicio_higienico %in% c(11)] <- "dentro_vivienda"
RECH23$servicio_higienico[RECH23$servicio_higienico %in% c(12)] <- "fuera_vivienda"
RECH23$servicio_higienico[RECH23$servicio_higienico %in% c(21)] <- "letrina_mejorada_ventilada"
RECH23$servicio_higienico[RECH23$servicio_higienico %in% c(22)] <- "pozo_septico"
RECH23$servicio_higienico[RECH23$servicio_higienico %in% c(23)] <- "letrina"
RECH23$servicio_higienico[RECH23$servicio_higienico %in% c(24)] <- "letrina_mejorada_flotante"
RECH23$servicio_higienico[RECH23$servicio_higienico %in% c(31)] <- "rio/acequia/canal"
RECH23$servicio_higienico[RECH23$servicio_higienico %in% c(32)] <- "campo/matorral"
RECH23$servicio_higienico[RECH23$servicio_higienico %in% c(96)] <- "otro"
```

Asignamos la categor칤a que corresponde a cada n칰mero para la variable *electricidad*

```{r}
RECH23$electricidad[RECH23$electricidad %in% c(0)] <- "no"
RECH23$electricidad[RECH23$electricidad %in% c(1)] <- "si"
```

Asignamos la categor칤a que corresponde a cada n칰mero para la variable *combustible_cocina*

```{r}
RECH23$combustible_cocina[RECH23$combustible_cocina %in% c(1)] <- "electricidad"
RECH23$combustible_cocina[RECH23$combustible_cocina %in% c(2)] <- "GLP"
RECH23$combustible_cocina[RECH23$combustible_cocina %in% c(3)] <- "gas natural"
RECH23$combustible_cocina[RECH23$combustible_cocina %in% c(5)] <- "kerosene"
RECH23$combustible_cocina[RECH23$combustible_cocina %in% c(6)] <- "carbon vegetal"
RECH23$combustible_cocina[RECH23$combustible_cocina %in% c(7)] <- "carbon mineral"
RECH23$combustible_cocina[RECH23$combustible_cocina %in% c(8)] <- "le침a"
RECH23$combustible_cocina[RECH23$combustible_cocina %in% c(9)] <- "ca침a/arbustos_secos"
RECH23$combustible_cocina[RECH23$combustible_cocina %in% c(10)] <- "residuos_agricolas"
RECH23$combustible_cocina[RECH23$combustible_cocina %in% c(11)] <- "bosta"
RECH23$combustible_cocina[RECH23$combustible_cocina %in% c(95)] <- "no_cocina"
RECH23$combustible_cocina[RECH23$combustible_cocina %in% c(96)] <- "otro"
```

Asignamos la categor칤a que corresponde a cada n칰mero para la variable *alumbrado (sh070)*

```{r}
RECH23$alumbrado[RECH23$alumbrado %in% c(1)] <- "electricidad"
RECH23$alumbrado[RECH23$alumbrado %in% c(2)] <- "GLP"
RECH23$alumbrado[RECH23$alumbrado %in% c(3)] <- "gas natural"
RECH23$alumbrado[RECH23$alumbrado %in% c(4)] <- "kerosene"
RECH23$alumbrado[RECH23$alumbrado %in% c(5)] <- "velas"
RECH23$alumbrado[RECH23$alumbrado %in% c(6)] <- "bateria"
RECH23$alumbrado[RECH23$alumbrado %in% c(96)] <- "otro"
```

Asignamos la categor칤a que corresponde a cada n칰mero para la variable *indice_riqueza (hv270)*

```{r}
RECH23$indice_riqueza[RECH23$indice_riqueza %in% c(1)] <- "muy_pobre"
RECH23$indice_riqueza[RECH23$indice_riqueza %in% c(2)] <- "pobre"
RECH23$indice_riqueza[RECH23$indice_riqueza %in% c(3)] <- "medio"
RECH23$indice_riqueza[RECH23$indice_riqueza %in% c(4)] <- "rico"
RECH23$indice_riqueza[RECH23$indice_riqueza %in% c(5)] <- "muy_rico"
```

### Filtro de las variables

Vamos a descartar las observaciones que no tengan informaci칩n, no tengan variabilidad o contengan datos at칤picos.

#### RECH0

En este dataset se encuentra un atributo que determina el si se realizo la entrevista en el hogar seleccionado o no, siendo la opcion 1 que si esta completada. Vamos a requerir las encuestas completadas.

```{r}
RECH0 <- filter(RECH0, estado_entrevista == 1)
```

#### REC0111

En este dataset tambi칠n se encuentran el estado de las entrevistas, donde el valor 1 significa que esta completada.

```{r}
REC0111 <- filter(REC0111, estado_entrevista == 1)
```

#### RECH5

Realizamos un filtro en funci칩n de la variable *estado_medicion* y *estado_medicion_hemoglobina,* en donde el valor 0 significa que si se completo la medici칩n de cada uno.

Existe un valor que rellena los espacios de ciertos atributos debido a que, aun por aceptar ser parte de una medici칩n, no se cumpli칩, y cuyo espacio se llena con el m치ximo n칰mero que se puede tomar con la cantidad m치xima de d칤gitos disponibles que toma el atributo. Estos los vamos a filtrar con *talla*, que al contener el valor no considerado (999 para la ocasi칩n), da se침al que la medici칩n general al final no se pudo tomar. Tambi칠n se va a cambiar el valor de la hemoglobina y hemoglobina ajustada para que se encuentren en la magnitud de gramos de hemoglobina por decilitro, adem치s de filtrar a los atributos que aun presenten datos faltantes.

```{r}
RECH5 <- filter(RECH5, estado_medicion == 0)
RECH5 <- filter(RECH5, estado_medicion_hemoglobina == 0)

RECH5 <- RECH5 %>%
  mutate(
    talla = ifelse(talla >= 999, NA, talla),
    hemoglobina = hemoglobina / 10,  # Convertir 'hemoglobina' a una escala razonable
    hemoglobina_ajustada_latitud = hemoglobina_ajustada_latitud / 10  # Convertir 'hemoglobina' a una escala razonable
  ) %>% na.omit()

# Verificar el resumen del marco de datos despu칠s de las transformaciones

summary(RECH5)
```

#### REC44

Realizamos un filtro en funci칩n de la variable *estado_medicion* y *estado_medicion_hemoglobina.*

Se realiza el mismo filtro que con RECH5.

```{r}
REC44 <- select(REC44_raw, CASEID, HW1, HW2, HW3, HW13, HW53, HW55, HW56, HW57)

REC44 <- rename(REC44,
                cuestionario_individual_id = CASEID,
                edad = HW1,
                peso = HW2,
                talla = HW3,
                estado_medicion = HW13,
                hemoglobina = HW53,
                estado_medicion_hemoglobina = HW55,
                hemoglobina_ajustada_latitud = HW56,
                anemia = HW57)

REC44$estado_medicion <- as.character(REC44$estado_medicion)
REC44$estado_medicion_hemoglobina <- as.character(REC44$estado_medicion_hemoglobina)
REC44$anemia <- as.character(REC44$anemia)

str(REC44)
```

#### RECH23

Filtramos a las filas donde los hogares no participaron, tomando a una variable cualquiera y filtrando su fila si su espacio esta vac칤o o no.

```{r}
RECH23 <- filter(RECH23, !is.na(fuente_agua))
str(RECH23)
```

## An치lisis de datos

### Objetivo 1

Describir los casos de anemia y su severidad en ni침os y madres en el Per칰 en el a침o 2022.

#### Anemia en ni침os

Promedio de edad, talla, peso y hemoglobina en ni침os con anemia leve, moderada y grave.

```{r}
ni침os_anemia_leve = filter(REC44, anemia == "leve")
ni침os_anemia_moderada = filter(REC44, anemia == "moderado")
ni침os_anemia_grave = filter(REC44, anemia == "grave")

ni침os_promedios_anemia_leve <- data.frame(colMeans(ni침os_anemia_leve[, sapply(ni침os_anemia_leve, is.numeric)]))
ni침os_promedios_anemia_moderada <- data.frame(colMeans(ni침os_anemia_moderada[, sapply(ni침os_anemia_moderada, is.numeric)]))
ni침os_promedios_anemia_grave <- data.frame(colMeans(ni침os_anemia_grave[, sapply(ni침os_anemia_grave, is.numeric)]))

print(ni침os_promedios_anemia_leve)
print(ni침os_promedios_anemia_moderada)
print(ni침os_promedios_anemia_grave)
```

#### Anemia en mujeres

Promedio de edad, talla, peso y hemoglobina en mujeres con anemia leve, moderada y grave.

```{r}
madres_anemia_leve = filter(RECH5, anemia == "leve")
madres_anemia_moderada = filter(RECH5, anemia == "moderado")
madres_anemia_grave = filter(RECH5, anemia == "grave")

madres_promedios_anemia_leve <- data.frame(colMeans(madres_anemia_leve[, sapply(madres_anemia_leve, is.numeric)]))
madres_promedios_anemia_moderada <- data.frame(colMeans(madres_anemia_moderada[, sapply(madres_anemia_moderada, is.numeric)]))
madres_promedios_anemia_grave <- data.frame(colMeans(madres_anemia_grave[, sapply(madres_anemia_grave, is.numeric)]))

print(madres_promedios_anemia_leve)
print(madres_promedios_anemia_moderada)
print(madres_promedios_anemia_grave)
```

```         
```

Analizar el 칤ndice de anemia en ni침os en las diversas regiones del Per칰 en el a침o 2022.

```{r}
#REC44_joined = inner_join(REC44, REC0111, by = "cuestionario_individual_id")
```

Analizar el 칤ndice de anemia en madres en las diversas regiones del Per칰 en el a침o 2022.

```{r}
#RECH5_joined = inner_join(RECH5, REC0111, by = "cuestionario_individual_id")

#REC0111_madres <- inner_join(REC0111, madres_anemia_leve, by = "cuestionario_individual_id")
```

### Objetivo 3

Describir las caracter칤sticas sociales de los grupos vulnerables ---ni침os y madres--- a la anemia en el Per칰 en el a침o 2022.

Primero, analizaremos la relaci칩n entre el tipo de residencia y el nivel de anemia de los ni침os.

```{r}
ni침os_anemia <- bind_rows(ni침os_anemia_leve, ni침os_anemia_moderada, ni침os_anemia_grave)

ni침os <- inner_join(REC0111, ni침os_anemia, by = "cuestionario_individual_id")

tabla_ni침os_residencia <- table(ni침os$tipo_de_residencia, ni침os$anemia)

tabla_ni침os_residencia 

```

```{r}
library(ggplot2)

df <- as.data.frame(tabla_ni침os_residencia)

colnames(df) <- c("tipo_de_residencia", "anemia", "frecuencia")

df$tipo_de_residencia <- as.factor(df$tipo_de_residencia)
df$tipo_de_residencia <- recode(df$tipo_de_residencia, 
                                `1` = "Urbano", 
                                `2` = "Rural")
df$anemia <- as.factor(df$anemia)


ggplot(df, aes(x = tipo_de_residencia, y = frecuencia, fill = anemia)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Tipo de Residencia", y = "Frecuencia", fill = "Nivel de Anemia en ni침os") +
  theme_minimal()
```

```{r}
library(gt)

df <- data.frame(
  tipo_de_residencia = c(1, 2),
  grave = c(14, 13),
  leve = c(3223, 1891),
  moderado = c(1232, 967)
)

df$total <- rowSums(df[,2:4])

df$tipo_de_residencia <- as.factor(df$tipo_de_residencia)
df$tipo_de_residencia <- recode(df$tipo_de_residencia, 
                                `1` = "Urbano", 
                                `2` = "Rural")

gt(df) %>%
  tab_header(
    title = "Tabla de Contingencia",
    subtitle = "Tipo de Residencia vs Nivel de Anemia"
  ) %>%
  cols_label(
    tipo_de_residencia = "Tipo de Residencia",
    grave = "Grave",
    leve = "Leve",
    moderado = "Moderado",
    total = "Total"
  ) %>%
  fmt_number(
    columns = vars(grave, leve, moderado, total),
    decimals = 0
  )

```

Como podemos observar, la proporci칩n entre los distintos tipos de anemia es bastante similar sea el tipo de residencia urbano o rural.

# Ideas para graficar (7 horas avanzando, no puedo m치s 游)

-   Mediana y promedio de las 3 regiones con mayor cantidad de casos de anemia (o sea, con nivel de anemia cualquiera excepto los que son "sin anemia"). Con ellos obtenemos los coeficientes de variaci칩n de cada uno (asi ya cumplimos lo de la rubrica sobre analisis univariado 游떂)

-   Obtener el porcentaje de embarazadas de todas las que tienen anemia. Servir칤a para ver si es necesario atender a ellas con urgencia. Se podr칤a hacer un boxplot tambien para saber los mayores niveles de anemia. Si hay varias que son atipicas, decir que sirvio lo que buscamos, que es preocupante que hayan varias con ese nivel.

-   Diagramas de dispersi칩n de casos de anemia con pesos, tallas y edad. Ver si hay una tendencia.

-   Un grafico de barras multiple con los valores de agua, servicios higienicos, combustible y alumbrado con lso niveles de anemia. Aunque si no quieren tanto trabajo, haganlo nomas con el indice de riqueza, que eso podria bastar xd

## Hay que cumplir con lo de analisis univariado y analisis de descripcion. Minimo es uno con categorico-numerico, categorico-categorico y numerico-numerico.

Eso y ya se acaba gente :,)

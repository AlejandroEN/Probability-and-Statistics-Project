---
title: "Anemia en infantes y mujeres"
format: html
editor: visual
authors:
  - name: "Colque Ordoñez, Patrick Fabrizio "
  - name: "Rejas Albujar, Alejandro David"
  - name: "Escobar Núñez, Alejandro Ismael"
toc: true
theme: vapor
---

![](UTEC.png){fig-align="left" width="252"}

# **Análisis de los casos de anemia en infantes y mujeres de 12 a 49 años en el Perú en el año 2022**

## 1. Introducción

### 1.1 Relevancia

La anemia es un problema de salud pública de gran relevancia en nuestro país. La falta de hemoglobina en la sangre puede tener consecuencias graves, especialmente en niños y madres. Además, la anemia puede afectar el desarrollo físico y cognitivo de los niños y aumentar el riesgo de complicaciones en el embarazo para las madres; por lo tanto, comprender la prevalencia y severidad de la anemia en estos grupos es esencial para abordar adecuadamente este problema de salud en el país.

### 1.2 Objetivos

-   Describir los casos de anemia y su severidad en niños y mujeres en el Perú en el año 2022.

-   Analizar el índice de anemia en las diversas regiones del Perú en el año 2022.

-   Describir las características sociales de los grupos vulnerables (niños y mujeres) a la anemia en el Perú en el año 2022.

### 1.3 Contexto

En el mes de mayo del año 2022, se llevó a cabo en nuestro país la Encuesta Demográfica y de Salud Familiar, un estudio que recopiló datos de una muestra representativa de viviendas en todo el territorio peruano. Este estudio se basó en tres cuestionarios diseñados específicamente: uno dirigido a todos los miembros de cada hogar, otro enfocado en mujeres cuyas edades se encontraban en el rango de 12 a 49 años, y un tercero destinado a individuos de 15 años o más.

En el contexto de esta encuesta, se solicitó a los residentes de los hogares su participación en una evaluación destinada a conocer sus niveles de hemoglobina en la sangre, a la que podían optar por unirse o no.

La totalidad de la información recopilada en esta encuesta se encuentra disponible para consulta por parte de cualquier ciudadano en la base de datos del Instituto Nacional de Estadística e Informática (INEI). Los datos se presentan organizados en módulos temáticos, y nuestro enfoque recae en los análisis de los casos de anemia en infantes y mujeres.

### 1.4 Instalación y carga de librerías

```{r, echo=FALSE}

if(!require(readr)) {install.packages("readr")}
if(!require(dplyr)) {install.packages("dplyr")}
if(!require(ggplot2)) {install.packages("ggplot2")}
if(!require(gt)) {install.packages("gt")}
if(!require(rriskDistributions)) {install.packages("rriskDistributions")}
if(!require(knitr)) {install.packages("knitr")}
if(!require(kableExtra)) {install.packages("kableExtra")}
```

```{r}

library(readr)
library(dplyr)
library(ggplot2)
library(gt)
library(rriskDistributions)
library(knitr)
library(kableExtra)
```

## 2. Datos

### 2.1 Recolección de datos

Los datos para este estudio se obtuvieron a partir de la Encuesta Demográfica y de Salud Familiar realizada en mayo de 2022 en el Perú. Se seleccionaron módulos específicos que eran relevantes para nuestro estudio sobre la anemia en niños y mujeres. Estos módulos incluían información sobre las características de los hogares y sus integrantes. El acceso a esta base de datos nos proporcionó una amplia cantidad de información relevante y detallada para nuestros objetivos de investigación.

### 2.2 Población objetivo, muestra y muestreo

-   **Población:** Miembros de los hogares de la Encuesta Demográfica y de Salud Familiar.

-   **Muestra:** Mujeres de 12 a 49 años de edad y niños o niñas menores de 5 años residentes de los hogares particulares recogidos por la encuesta.

-   **Muestreo:** Probabilístico por conglomerados.

### 2.3 Variables

-   **Tabla RECH0:** Características del hogar

-   **Tabla RECH5:** Peso y talla (anemia). Características de las mujeres de 12 a 49 años.

-   **Tabla REC0111:** Datos básicos del MEF. Relación entre identificación del cuestionario individual e identificación del cuestionario del hogar.

-   **Tabla REC44:** Peso y talla (anemia). Características de los infantes de 0 a 59 meses (5 años aproximadamente) seleccionados por hogar.

-   **Tabla RECH23:** Características del hogar de los participantes. Estos contienen las características del modo de vida de los que respondieron la encuesta.

```{r, message=FALSE}

REC0111 <- read_csv("REC0111_clean.csv")
RECH5 <- read_csv("RECH5_clean.csv")
REC44 <- read_csv("REC44_clean.csv")
RECH23 <- read_csv("RECH23_clean.csv")
RECH0 <- read_csv("RECH0_clean.csv")
```

## 3. Análisis descriptivo univariado

### 3.1 Variables numéricas

#### 3.1.1 Hemoglobina de infantes

```{r, echo=FALSE}

ggplot(filter(REC44, !is.na(hemoglobina)), aes(x = "", y = hemoglobina)) +
  geom_boxplot(fill = "#66c2a5", color = "#333333") +
  labs(title = "Boxplot del Nivel de Hemoglobina",
       x = "",
       y = "Nivel de Hemoglobina (g/dl)") +
  theme_minimal()
```

Descriptores numéricos:

```{r, echo=FALSE}

kable(REC44 %>% 
        summarize(Media = round(mean(hemoglobina), 2),
                  Mediana = round(median(hemoglobina), 2),
                  Mínimo = min(hemoglobina), Máximo=max(hemoglobina),
                  SD = round(sd(hemoglobina), 2),
                  Q1 = round(quantile(hemoglobina, 0.25, type = 3), 2),
                  Q3 = round(quantile(hemoglobina, 0.75, type = 3), 2)))
```

#### 3.1.2 Peso de infantes

```{r, echo=FALSE}

ggplot(filter(REC44, !is.na(peso)), aes(x = "", y = peso)) +
  geom_boxplot(fill = "#66c2a5", color = "#333333") +
  labs(title = "Boxplot del Nivel de peso",
       x = "",
       y = "Nivel de peso kg") +
  theme_minimal()
```

Descriptores numéricos:

```{r, echo=FALSE}

kable(REC44 %>% 
        summarize(Media = round(mean(peso), 2),
                  Mediana = round(median(peso), 2),
                  Mínimo = min(peso), Máximo=max(peso),
                  SD = round(sd(peso), 2),
                  Q1 = round(quantile(peso, 0.25, type = 3), 2),
                  Q3 = round(quantile(peso, 0.75, type = 3), 2)))
```

#### 3.1.3 Talla de infantes

```{r, echo=FALSE}

ggplot(filter(REC44, !is.na(talla)), aes(x = "", y = talla)) +
  geom_boxplot(fill = "#66c2a5", color = "#333333") +
  labs(title = "Boxplot del Nivel de talla",
       x = "",
       y = "Nivel de talla (cm)") +
  theme_minimal()
```

Descriptores numéricos:

```{r, echo=FALSE}

kable(REC44 %>% 
        summarize(Media = round(mean(talla), 2),
                  Mediana = round(median(talla), 2),
                  Mínimo = min(talla), Máximo=max(talla),
                  SD = round(sd(talla), 2),
                  Q1 = round(quantile(talla, 0.25, type = 3), 2),
                  Q3 = round(quantile(talla, 0.75, type = 3), 2)))
```

### 3.2 Variables categóricas

#### 3.2.1 Nivel de anemia en niños

#### 3.1.1 Nivel de anemia en niños

Hallamos el promedio de la edad, la talla, el peso y la hemoglobina en niños con anemia leve, moderada y grave para comparar la información de los tres tipos de anemia.

```{r, echo=FALSE}

niños_anemia_leve = filter(REC44, anemia == "1.leve")
niños_anemia_moderada = filter(REC44, anemia == "2.moderado")
niños_anemia_grave = filter(REC44, anemia == "3.grave")

niños_promedios_anemia_leve <-
  data.frame(colMeans(niños_anemia_leve[ ,
                                         sapply(niños_anemia_leve,
                                                is.numeric)]))


niños_promedios_anemia_moderada <-
  data.frame(colMeans(niños_anemia_moderada[ ,
                                             sapply(niños_anemia_moderada,
                                                    is.numeric)]))

niños_promedios_anemia_grave <-
  data.frame(colMeans(niños_anemia_grave[ ,
                                          sapply(niños_anemia_grave,
                                                 is.numeric)]))

kable(niños_promedios_anemia_leve,
      caption = "Promedios Anemia Leve",
      col.names = c("Variable", "Promedio")) %>%
  kable_styling(full_width = FALSE)

kable(niños_promedios_anemia_moderada,
      caption = "Promedios Anemia Moderada",
      col.names = c("Variable", "Promedio")) %>%
  kable_styling(full_width = FALSE)

kable(niños_promedios_anemia_grave,
      caption = "Promedios Anemia Grave",
      col.names = c("Variable", "Promedio")) %>%
  kable_styling(full_width = FALSE)
```

Representamos de forma gráfica las edades de cada niño con su nivel de anemia.

```{r, echo=FALSE}

hist(niños_anemia_leve$edad,
     main = "Edad de los infantes con anemia leve en meses",
     xlab = "Edad",
     ylab = "Número de infantes",
     col = "skyblue")

abline(v = mean(niños_anemia_leve$edad),
       col = "red",
       lwd = 4)

abline(v = median(niños_anemia_leve$edad),
       col = "orange",
       lwd = 3)

abline(v = mean(niños_anemia_leve$edad) - 1 * sd(niños_anemia_leve$edad),
       col = "chartreuse4",
       lwd = 4)

abline(v = mean(niños_anemia_leve$edad) + 1 * sd(niños_anemia_leve$edad),
       col = "chartreuse4",
       lwd = 4)

abline(v = quantile(niños_anemia_leve$edad,
                    0.25,
                    type = 3),
       col = "deeppink",
       lwd = 4)

abline(v = quantile(niños_anemia_leve$edad,
                    0.75,
                    type = 3),
       col = "darkorchid4",
       lwd = 4)

legend("topright",
       legend = c("Media",
                  "Mediana",
                  "Media más/menos desv. estándar",
                  "Cuantil(0.25)",
                  "Cuantil(0.75)"),
       col = c("red",
               "orange",
               "chartreuse4",
               "deeppink",
               "darkorchid4"),
       lwd = 2,
       cex = 0.75)
```

```{r, echo=FALSE}

hist(niños_anemia_moderada$edad,
     main = "Edad de los infantes con anemia moderada en meses",
     xlab = "Edad",
     ylab = "Número de infantes",
     col = "skyblue")

abline(v = mean(niños_anemia_moderada$edad),
       col = "red",
       lwd = 4)

abline(v = median(niños_anemia_moderada$edad),
       col = "orange",
       lwd=3)

abline(v = mean(niños_anemia_moderada$edad) - 1 *
         sd(niños_anemia_moderada$edad),
       col = "chartreuse4",
       lwd = 4)

abline(v = mean(niños_anemia_moderada$edad) + 1 *
         sd(niños_anemia_moderada$edad),
       col = "chartreuse4",
       lwd = 4)

abline(v = quantile(niños_anemia_moderada$edad,
                    0.25,
                    type = 3),
       col = "deeppink",
       lwd = 4)

abline(v = quantile(niños_anemia_moderada$edad,
                    0.75,
                    type = 3),
       col = "darkorchid4",
       lwd = 4)

legend("topright",
       legend = c("Media",
                  "Mediana",
                  "Media más/menos desv. estándar",
                  "Cuantil (0.25)",
                  "Cuantil (0.75)"),
       col = c("red",
               "orange",
               "chartreuse4",
               "deeppink",
               "darkorchid4"),
       lwd = 2,
       cex = 0.75)
```

```{r, echo=FALSE}

hist(niños_anemia_grave$edad,
     main = "Edad de los infantes con anemia grave en meses",
     xlab = "Edad",
     ylab = "Número de infantes",
     col = "skyblue")

abline(v = mean(niños_anemia_grave$edad),
       col = "red",
       lwd = 4)

abline(v = median(niños_anemia_grave$edad),
       col = "orange",
       lwd = 3)

abline(v = mean(niños_anemia_grave$edad) - 1 *
         sd(niños_anemia_grave$edad),
       col = "chartreuse4",
       lwd = 4)

abline(v = mean(niños_anemia_grave$edad) + 1 *
         sd(niños_anemia_grave$edad),
       col = "chartreuse4",
       lwd = 4)

abline(v = quantile(niños_anemia_grave$edad,
                    0.25,
                    type = 3),
       col = "deeppink",
       lwd = 4)

abline(v = quantile(niños_anemia_grave$edad,
                    0.75,
                    type = 3),
       col = "darkorchid4",
       lwd = 4)

legend("topright",
       legend = c("Media",
                  "Mediana",
                  "Media más/menos desv. estándar",
                  "Cuantil (0.25)",
                  "Cuantil (0.75)"),
       col = c("red",
               "orange",
               "chartreuse4",
               "deeppink",
               "darkorchid4"),
       lwd = 2,
       cex = 0.75)
```

Para los casos leves de infantes la mayor concentración se encuentra por los 10 y 45 meses; para los casos moderados, por los 5 y 35 meses; y, para los casos graves, por los 7 y 30 años. Para los tres casos, la información se encuentra muy dispersa, reconociendo solo al gráfico de los casos de anemia moderada como una campana asimétrica hacia la izquierda.

#### 3.1.2 Nivel de anemia en mujeres

Hallamos el promedio de la edad, la talla, el peso y la hemoglobina en mujeres con anemia leve, moderada y grave para comparar la información de los tres tipos de anemia.

```{r, echo=FALSE}

mujeres_anemia_leve = filter(RECH5, anemia == "1.leve")
mujeres_anemia_moderada = filter(RECH5, anemia == "2.moderado")
mujeres_anemia_grave = filter(RECH5, anemia == "3.grave")

mujeres_promedios_anemia_leve <-
  data.frame(colMeans(mujeres_anemia_leve[ ,
                                          sapply(mujeres_anemia_leve,
                                                 is.numeric)]))

mujeres_promedios_anemia_moderada <-
  data.frame(colMeans(
    mujeres_anemia_moderada[ ,
                             sapply(mujeres_anemia_moderada,
                                    is.numeric)]))

mujeres_promedios_anemia_grave <-
  data.frame(colMeans(
    mujeres_anemia_grave[ ,
                          sapply(mujeres_anemia_grave,
                                 is.numeric)]))

kable(mujeres_promedios_anemia_leve,
      caption = "Promedios Anemia Leve",
      col.names = c("Variable", "Promedio")) %>%
  kable_styling(full_width = FALSE)

kable(mujeres_promedios_anemia_moderada,
      caption = "Promedios Anemia Moderada",
      col.names = c("Variable", "Promedio")) %>%
  kable_styling(full_width = FALSE)

kable(mujeres_promedios_anemia_grave,
      caption = "Promedios Anemia Grave",
      col.names = c("Variable", "Promedio")) %>%
  kable_styling(full_width = FALSE)
```

Representamos de forma gráfica las edades de cada mujer con su nivel de anemia.

```{r, echo=FALSE}

hist(mujeres_anemia_leve$edad,
     main = "Edad de las mujeres con anemia leve en meses",
     xlab = "Edad",
     ylab = "Número de mujeres",
     col = "skyblue",
     xlim = c(10, 50))

abline(v = mean(mujeres_anemia_leve$edad),
       col = "red",
       lwd = 4)

abline(v = median(mujeres_anemia_leve$edad),
       col = "orange",
       lwd = 3)

abline(v = mean(mujeres_anemia_leve$edad) - 1 *
         sd(mujeres_anemia_leve$edad),
       col = "chartreuse4",
       lwd = 4)

abline(v = mean(mujeres_anemia_leve$edad) + 1 *
         sd(mujeres_anemia_leve$edad),
       col = "chartreuse4",
       lwd = 4)

abline(v = quantile(mujeres_anemia_leve$edad,
                    0.25,
                    type = 3),
       col = "deeppink",
       lwd = 4)

abline(v = quantile(mujeres_anemia_leve$edad,
                    0.75,
                    type = 3),
       col = "darkorchid4",
       lwd = 4)

legend("topright",
       legend = c("Media",
                  "Mediana",
                  "Media más/menos desv. estándar",
                  "Cuantil (0.25)",
                  "Cuantil (0.75)"),
       col = c("red",
               "orange",
               "chartreuse4",
               "deeppink",
               "darkorchid4"),
       lwd = 2,
       cex = 0.75)
```

```{r, echo=FALSE}

hist(mujeres_anemia_moderada$edad,
     main = "Edad de las muejeres con anemia moderada en meses",
     xlab = "Edad",
     ylab = "Número de mujeres",
     col = "skyblue",
     ylim=c(0,250))

abline(v = mean(mujeres_anemia_moderada$edad),
       col = "red",
       lwd=4)

abline(v = median(mujeres_anemia_moderada$edad),
       col = "orange",
       lwd = 3)

abline(v = mean(mujeres_anemia_moderada$edad) - 1 *
         sd(mujeres_anemia_moderada$edad),
       col = "chartreuse4",
       lwd = 4)

abline(v = mean(mujeres_anemia_moderada$edad) + 1 *
         sd(mujeres_anemia_moderada$edad),
       col = "chartreuse4" ,
       lwd = 4)

abline(v = quantile(mujeres_anemia_moderada$edad,
                    0.25,
                    type = 3),
       col = "deeppink",
       lwd = 4)

abline(v = quantile(mujeres_anemia_moderada$edad,
                    0.75,
                    type = 3),
       col = "darkorchid4",
       lwd = 4)

legend("topright",
       legend = c("Media",
                  "Mediana",
                  "Media más/menos desv. estándar",
                  "Cuantil(0.25)",
                  "Cuantil(0.75)"),
       col = c("red",
               "orange",
               "chartreuse4",
               "deeppink",
               "darkorchid4"),
       lwd = 2,
       cex = 0.75)
```

```{r, echo=FALSE}

hist(mujeres_anemia_grave$edad,
     main = "Edad de las mujeres con anemia grave en meses",
     xlab = "Edad",
     ylab = "Número de mujeres",
     col = "skyblue",
     ylim = c(0, 30))

abline(v = mean(mujeres_anemia_grave$edad),
       col = "red",
       lwd = 4)

abline(v = median(mujeres_anemia_grave$edad),
       col = "orange",
       lwd = 3)

abline(v = mean(mujeres_anemia_grave$edad) - 1 *
         sd(mujeres_anemia_grave$edad),
       col = "chartreuse4",
       lwd = 4)

abline(v = mean(mujeres_anemia_grave$edad) + 1 *
         sd(mujeres_anemia_grave$edad),
       col = "chartreuse4",
       lwd = 4)

abline(v = quantile(mujeres_anemia_grave$edad,
                    0.25,
                    type = 3),
       col = "deeppink",
       lwd = 4)

abline(v = quantile(mujeres_anemia_grave$edad,
                    0.75,
                    type = 3),
       col = "darkorchid4",
       lwd = 4)

legend("topright",
       legend = c("Media",
                  "Mediana",
                  "Media más/menos desv. estándar",
                  "Cuantil(0.25)",
                  "Cuantil(0.75)"),
       col = c("red",
               "orange",
               "chartreuse4",
               "deeppink",
               "darkorchid4"),
       lwd = 2,
       cex = 0.75)
```

Para los casos leves de mujeres la mayor concentración se encuentra por los 17 y 38 años; para los casos moderados, por los 20 y 35 meses; y, para los casos graves, por los 22 y 44 años. Igualmente los datos se encuentran muy dispersos, reconociendo que para los casos de anemia leve, hay un descenso mientras aumenta la edad.

## 4. Análisis descriptivo de interacción

Analizaremos la relación entre el tipo de residencia y el nivel de anemia de los niños.

```{r}

niños_anemia <- bind_rows(niños_anemia_leve,
                          niños_anemia_moderada,
                          niños_anemia_grave)

niños <- inner_join(REC0111,
                    niños_anemia,
                    by = "cuestionario_individual_id")

tabla_niños_residencia <- table(niños$tipo_de_residencia, niños$anemia)

tabla_niños_residencia
```

```{r}

Tipo_de_Residencia_vs_Nivel_de_Anemia <-
  as.data.frame((tabla_niños_residencia / rowSums(tabla_niños_residencia))
                * 100)

colnames(Tipo_de_Residencia_vs_Nivel_de_Anemia) <- c("tipo_de_residencia",
                                                     "anemia",
                                                     "frecuencia")

Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia <-
  as.factor(Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia)

Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia <-
  recode(Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia,
         `1` = "Urbano",
         `2` = "Rural")

Tipo_de_Residencia_vs_Nivel_de_Anemia$anemia <-
  as.factor(Tipo_de_Residencia_vs_Nivel_de_Anemia$anemia)

ggplot(Tipo_de_Residencia_vs_Nivel_de_Anemia,
       aes(x = tipo_de_residencia,
           y = frecuencia,
           fill = anemia)) +
geom_bar(stat = "identity",
         position = "dodge") +
labs(x = "Tipo de Residencia",
     y = "Frecuencia",
     fill = "Nivel de Anemia en niños") +
theme_minimal()

Tipo_de_Residencia_vs_Nivel_de_Anemia <-
  data.frame(tipo_de_residencia = c(1, 2),
             grave = c(14, 13),
             leve = c(3223, 1891),
             moderado = c(1232, 967))

Tipo_de_Residencia_vs_Nivel_de_Anemia$total <-
  rowSums(Tipo_de_Residencia_vs_Nivel_de_Anemia[ , 2:4])

Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia <-
  as.factor(Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia)

Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia <-
  recode(Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia,
         `1` = "Urbano",
         `2` = "Rural")

gt(Tipo_de_Residencia_vs_Nivel_de_Anemia) %>%
  tab_header(title = "Tabla de Contingencia",
             subtitle = "Tipo de Residencia vs Nivel de Anemia") %>%
    cols_label(tipo_de_residencia = "Tipo de Residencia",
               grave = "Grave",
               leve = "Leve",
               moderado = "Moderado",
               total = "Total") %>%
      fmt_number(columns = vars(grave, leve, moderado, total),
                 decimals = 0)
```

Como podemos observar, la proporción entre los distintos tipos de anemia es bastante similar sea el tipo de residencia urbano o rural.

Gráfico donde se tomen las tres regiones con mas casos en infantes para luego compararlos.

```{r}

regiones_casos_infantes <-
  merge(REC0111,
        (select(REC44,
                anemia,
                cuestionario_individual_id))[REC44$anemia!="0.sin_anemia", ],
        by = "cuestionario_individual_id")

regiones_casos_infantes_orden <- sort(table(regiones_casos_infantes$region),
                                      decreasing = TRUE)

tres_regiones_mas_casos_i <- head(regiones_casos_infantes_orden, 3)

tres_regiones_mas_casos_i <-
  regiones_casos_infantes[(regiones_casos_infantes$region %in%
                             names(tres_regiones_mas_casos_i)), ]

tabla_tres_regiones_i <- (table(tres_regiones_mas_casos_i$region,
                                tres_regiones_mas_casos_i$anemia))

barplot(t(tabla_tres_regiones_i),
        col = 2:4,
        xlab = "Regiones",
        ylab = "Nivel de anemia",
        ylim = c(0, 1000),
        main = "Distribución según anemia y region")

legend("topright",
       legend = c("Leve", "Moderado", "Grave"),
       col = 2:4,
       cex = 1.0,
       pch = 15,
       title = "Nivel de anemia")
```

Hacemos el mismo proceso con las mujeres seleccionadas.

```{r}

regiones_casos_mujeres <-
  merge((select(RECH5,
                anemia,
                cuestionario_individual_id))[RECH5$anemia != "0.sin_anemia", ],
        REC0111,
        by.x = "cuestionario_individual_id",
        by.y = "cuestionario_hogar_id")

regiones_casos_mujeres_orden <- sort(table(regiones_casos_mujeres$region),
                                     decreasing = TRUE)

tres_regiones_mas_casos_m <- head(regiones_casos_mujeres_orden, 3)

tres_regiones_mas_casos_m <-
  regiones_casos_mujeres[(regiones_casos_mujeres$region %in%
                            names(tres_regiones_mas_casos_m)), ]

tabla_tres_regiones_m <- table(tres_regiones_mas_casos_m$region,
                               tres_regiones_mas_casos_m$anemia)

barplot(t(tabla_tres_regiones_m),
        col = 2:4,
        xlab = "Region",
        ylab = "Nivel de anemia",
        ylim = c(0,2000),
        main = "Distribución según anemia y region")

legend("topright",
       legend = c("Leve","Moderado","Grave"),
       col = 2:4,
       cex = 1.0,
       pch = 15,
       title = "Nivel de anemia")
```

Se nota que para ambos casos, siempre los casos leves son los predominantes.

La elección de las tres regiones con más casos es porque deben ser las regiones donde hay que preocuparse más en combatir a la enfermedad.

Boxplots entre hemoglobina e indice de riqueza con las mujeres

```{r}

ds_hemoglobina_riqueza <-
  merge((select(RECH5,
                hemoglobina,
                cuestionario_individual_id)),
        RECH23,
        by.x = "cuestionario_individual_id",
        by.y = "cuestionario_hogar_id")

boxplot(ds_hemoglobina_riqueza$hemoglobina ~ ds_hemoglobina_riqueza$indice_riqueza,
        col = c("#E63946", "#2A9D8F", "#F4A261", "#264653", "#F4D35E"),
        names = c("Muy pobre", "Pobre", "Medio", "Rico", "Muy rico"),
        xlab = "Índice de riqueza",
        ylab = "Nivel de hemoglobina (gr/dl)")
```

De todos los índices de riqueza, con los mas pobres es donde existe mayor dispersión. No hay mucha distinción en los casos bajos de hemoglobina por cada separación (que indica si presenta anemia).

# Probabilidades

## Probabilidad empírica

#### Variable A: Índice de riqueza

**Experimento 1:** Escoger un hogar que aceptó participar en la encuesta y observar su **índice de riqueza**.

**Espacio muestral (** $\Omega$ **).**

```{r}

unique(RECH23$indice_riqueza)
```

$$
\Omega = E1, \; E2, \; E3, \; E4, \; E5
$$

**Eventos atómicos**:

-   $E1$: Que se escoja un hogar cuyo índice de riqueza sea muy pobre
-   $E2$: Que se escoja un hogar cuyo índice de riqueza sea pobre
-   $E3$: Que se escoja un hogar cuyo índice de riqueza sea medio
-   $E4$: Que se escoja un hogar cuyo índice de riqueza sea rico
-   $E5$: Que se escoja un hogar cuyo índice de riqueza sea muy rico

**Probabilidad de cada evento:**

$$
P(x) = \dfrac{f(x)}{n}
$$\

$f(x)$ = número de veces que se cumpla el evento en toda la muestra

$n$ = tamaño de la muestra

```{r}

prob_riqueza <- table(RECH23$indice_riqueza)/sum(table(RECH23$indice_riqueza))
prob_riqueza
```

```{r}

colores <- c("#66c2a5", "#fc8d62", "#8da0cb", "#e78ac3")

categorias <- c('Muy Pobre', 'Pobre', 'Medio', 'Rico', 'Muy Rico')

barplot(prob_riqueza, col = colores, names.arg = categorias,
        main = "Probabilidades de Riqueza", xlab = "Categorías", ylab = "Probabilidad", border = "black")
```

Comprobamos que todo sume uno (ya que son probabilidades de eventos atómicos en un espacio muestral $\Omega$ ).

```{r}

sum(table(RECH23$indice_riqueza)/sum(table(RECH23$indice_riqueza)))
```

Probabilidad de cada evento atómico:

P(**E1**) = 0.3151

P(**E2**) = 0.251

P(**E3**) = 0.1867

P(**E4**) = 0.1395

Determinamos el índice de riqueza con mayor y menor probabilidad de ser escogido:

```{r}

names(which.max(prob_riqueza))
names(which.min(prob_riqueza))
```

Al elegir un hogar para el experimento, es más probable que sea muy pobre y menos probable que sea muy rico.

#### Variable B: Nivel de anemia

**Experimento 2:** Seleccionar a un niño de entre los hogares que han aceptado participar en la prueba de hemoglobina y evaluar su **nivel de anemia**.

**Espacio muestral (** $\Omega$ **).**

```{r}

unique(REC44$anemia)
```

$$
\Omega = E1, E2, E3, E4
$$

**Eventos atómicos**:

**E1**: Que se escoja un infante participante que no tenga anemia.

**E2**: Que se escoja un infante participante cuyo nivel de anemia sea bajo.

**E3**: Que se escoja un infante participante cuyo nivel de anemia sea moderado.

**E4**: Que se escoja un infante participante cuyo nivel de anemia sea alto.

**Probabilidad por evento:**

```{r}

prob_anemia <- table(REC44$anemia)/length(REC44$anemia)
prob_anemia
```

```{r}

colores <- c("#66c2a5", "#fc8d62", "#8da0cb", "#e78ac3")

categorias <- c('Sin Anemia', 'Leve', 'Moderada', 'Grave')

barplot(prob_anemia, col = colores, names.arg = categorias,
        main = "Probabilidades de Anemia", xlab = "Categorías", ylab = "Probabilidad", border = "black")
```

Comprobamos que todo sume uno.

```{r}

sum(table(REC44$anemia)/length(REC44$anemia))
```

Probabilidad de cada evento atómico:

P(**E1**) = 0.6322

P(**E2**) = 0.2563

P(**E3**) = 0.1102

P(**E4**) = 0.0014

Nivel de anemia con mayor y menor probabilidad de ser escogida:

```{r}

names(which.max(prob_anemia))
names(which.min(prob_anemia))
```

Es más probable que, entre los niños seleccionados, uno no presente anemia y sea menos probable que esté en un estado grave de la misma.

## Probabilidad condicional

### Eventos dependientes

-   **A1**: Seleccionar una mujer de la muestra que esté embarazada.

-   **A2**: Seleccionar una mujer de la muestra que no esté embarazada.

Probabilidad del evento **A1**:

```{r}

table(RECH5$is_embarazada)
```

```{r}

A1 <-nrow(filter(RECH5, is_embarazada == "no embarazada"))/nrow(RECH5)
A1
```

Probabilidad del evento **A2**:

```{r}

A2 <-nrow(filter(RECH5, is_embarazada == "embarazada"))/nrow(RECH5)
A2
```

Vamos a probar que ambos eventos son **dependientes**, comprobando que son mutuamente excluyentes.

Probabilidad que ocurra **A1** y **A2**.

```{r}

'A1_&_A2' <- nrow(filter(RECH5, is_embarazada == "embarazada" & is_embarazada == "no embarazada"))
`A1_&_A2`
```

$$
P(A1 \cap A2) = 0
$$

Vemos que la intersección de ambos elementos es igual a cero. Al no haber intersección entre ambos eventos, se comprueba que son eventos dependientes.

Dado que ambos eventos son mutuamente excluyentes y abarcan todo el espacio muestral de un experimento, estamos tratando con una partición. En este contexto, podemos aplicar el teorema de la probabilidad total para analizar la situación.

**Teorema de la probabilidad total**:

$$ P(B) = P(B \mid A1)*P(A1) + P(B \mid A2)*P(A2) $$

Vamos a tomar un evento que pueda ocurrir en ambos. Este será el evento **B**, que representará si la mujer seleccionada tiene como mayor nivel educativo alcanzado la secundaria.

Probabilidad de que ocurra **B**:

```{r}

B <- sum(RECH5$nivel_educativo == "2.secundaria")/nrow(RECH5)
B
```

Observación:

$$P(x \mid y)*P(y) = P(x \cap y)$$

```{r}

prob_B_dado_A1_x_prob_A1 <- sum(RECH5$nivel_educativo == "2.secundaria" & RECH5$is_embarazada == 'embarazada') / nrow(RECH5)
prob_B_dado_A2_x_prob_A2 <- sum(RECH5$nivel_educativo == "2.secundaria" & RECH5$is_embarazada == 'no embarazada') / nrow(RECH5)

prob_total_B = prob_B_dado_A1_x_prob_A1 + prob_B_dado_A2_x_prob_A2

cat("Probabilidad total de B encontrada gracias al teorema de probabilidad total:", prob_total_B, "\n")
cat("Probabilidad empírica de B:", B, "\n")
cat("Las probabilidades coinciden.\n")
```

Por ser una partición, también se puede comprobar el teorema de Bayes.

**Teorema de Bayes**:

$$
P(A \mid B) = \frac{P(B \mid A)*P(A)}{P(B)}
$$

```{r}

prob_A1_dado_B <- prob_B_dado_A1_x_prob_A1/B
prob_A1_dado_B
```

$$
P(A1 \mid B) = 0.02863548
$$

La probabilidad de que la mujer escogida resulte embarazada dado que su máximo nivel educativo alcanzado es la secundaria es 0.02863548.

```{r}

prob_A2_dado_B <- prob_B_dado_A1_x_prob_A1/B
prob_A2_dado_B
```

$$
P(A2 \mid B) = 0.9713645
$$

Se puede concluir que la probabilidad de que la mujer escogida no esté embarazada dado que su máximo nivel educativo alcanzado es la secundaria es 0.9713645.

### Eventos independientes

-   **B1**: Seleccionar un niño que tenga anemia dado que vive en un lugar urbano.

-   **B2**: Seleccionar un niño que tenga anemia dado que vive en un lugar rural.

```{r}

niños_region <- merge(REC0111, select(REC44, anemia, cuestionario_individual_id), by = "cuestionario_individual_id")
```

Probabilidad del evento **B1**:

```{r}

niños_anemia_urbano <- filter(niños_region, tipo_de_residencia=="urbano" & anemia!="0.sin_anemia")
B1 <- (nrow(niños_anemia_urbano)/nrow(niños_region[niños_region$tipo_de_residencia=="urbano",]))
B1
```

Probabilidad del evento **B2**:

```{r}

niños_anemia_rural <- filter(niños_region, tipo_de_residencia=="rural" & anemia!="0.sin_anemia")
B2 <- (nrow(niños_anemia_rural)/nrow(niños_region[niños_region$tipo_de_residencia=="rural",]))
B2
```

Vamos a verificar la independencia de los eventos comparando la intersección manual de eventos con el producto de sus probabilidades. Según la regla, si dos eventos son independientes, el producto de sus probabilidades debe ser igual a la intersección de los eventos.

$$
P(B1 \cap B2) = P(B1)*P(B2)
$$

Intersección de los eventos obtenidos con combinatorias:

```{r}

choose((3223+1232+14),1)*choose((1891+967+13),1)/(choose(13570,1)*choose(6385,1))
```

Producto de las probabilidades de ambos eventos:

```{r}

B1_interseccion_B2 <- B1*B2
B1_interseccion_B2
```

Al observar que ambos resultados son iguales, podemos concluir que los dos eventos son independientes. Dado que son eventos independientes, podemos realizar las siguientes comprobaciones:

$$
P(B1 \mid B2) = B1
$$

```{r}

prob_B1_dado_B2 <- B1_interseccion_B2/B2
prob_B1_dado_B2
B1
```

$$
P(B2 \mid B1) = B2
$$

```{r}

prob_B2_dado_B1 <- B1_interseccion_B2/B1
prob_B2_dado_B1
B2
```

$$
P(B1 \cap B2^c) = P(B1) * P(B2^c)
$$

```{r}

prob_b1_int_b2c = choose((3223+1232+14),1)*(choose(3514,1))/(choose(13570,1)*choose(6385,1))
prob_b1_int_b2c
B1*(1-B2)
```

$$
P(B1^c \cap B2^c) = P(B1^c) * P(B2^c)
$$

```{r}

prob_b1c_int_b2c = choose((9101),1)*(choose((3514),1))/(choose(13570,1)*choose(6385,1))
prob_b1c_int_b2c
(1-B2)*(1-B1)
```

## Variables aleatorias discretas

### Número de niños con un determinado nivel de anemia

```{r}
table(REC44$anemia)
```

La variable "**Número de niños con un determinado nivel de anemia"** es discreta, ya que cuenta con precisión cuántos niños se encuentran en cada categoría de anemia (sin anemia, leve, moderado, grave). La discreción proviene de que los valores son enteros y específicos.

Tenemos los siguientes eventos:

**L**: Seleccionar a un niño con anemia cuyo nivel sea clasificado como leve.

**M**: Seleccionar a un niño con anemia cuyo nivel sea clasificado como moderado.

**G**: Seleccionar a un niño con anemia cuyo nivel sea clasificado como grave.

Vamos a tomar el evento **G** como nuestro éxito.

```{r}

L <- 5114
M <- 2199
G <- 27

Total <- L + M + G

PL <- L / Total
PM <- M / Total
PG <- G / Total

cat("Probabilidad de anemia leve (PL):", PL, "\n")
cat("Probabilidad de anemia moderada (PM):", PM, "\n")
cat("Probabilidad de anemia grave (PG):", PG, "\n")
```

La probabilidad de ocurra nuestro éxito (**G**):

$$
P(G) = 0.0037
$$

-   **Definimos nuestra variable aleatoria discreta**

**X**: Número de niños observados hasta encontrar el primer caso de anemia grave.

-   **Vamos a utilizar el modelo geométrico**

$$
X\sim G(p)
$$

-   **Definimos parámetros**

**p**: Probabilidad que el niño tenga anemia grave.

Observemos un gráfico de distribución geométrica en torno a nuestra variable aleatoria discreta '**X'**:

```{r}

p <- PG

X <- 0:500

plot(X, dgeom(X, p), type = "h", lwd = 2, col = "blue",
     ylab = "P(X = x)", xlab = "Número de chicos a observar hasta que uno tenga anemia grave",
     main = "Distribución Geométrica",
     sub = paste("Probabilidad de que un niño tenga anemia grave (PG): 0.0037"))
```

-   **Validamos las propiedades de esperanza, varianza, desviación estándar y coeficiente de variación**

```{r}

n <- Total
p <- PG

mu_geom <- 1 / p
variance_geom <- (1 - p) / p^2
sigma_geom <- sqrt(variance_geom)
cv_geom <- sigma_geom / mu_geom

probabilities_geom <- dgeom(0:n, p)
sample_mean_geom <- sum(probabilities_geom * seq_along(probabilities_geom))
sample_variance_geom <- sum(probabilities_geom * (seq_along(probabilities_geom) - sample_mean_geom)^2)
sample_sd_geom <- sqrt(sample_variance_geom)
sample_cv_geom <- sample_sd_geom / sample_mean_geom


cat("Media teórica (modelo geométrico):", mu_geom, "\n")
cat("Varianza teórica (modelo geométrico):", variance_geom, "\n")
cat("Desviación estándar teórica (modelo geométrico):", sigma_geom, "\n")
cat("Coeficiente de variación teórico (modelo geométrico):", cv_geom, "\n")
cat("Media práctica (modelo geométrico):", sample_mean_geom, "\n")
cat("Varianza práctica (modelo geométrico):", sample_variance_geom, "\n")
cat("Desviación estándar práctica (modelo geométrico):", sample_sd_geom, "\n")
cat("Coeficiente de variación práctico (modelo geométrico):", sample_cv_geom, "\n")
```

Los resultados teóricos y prácticos en el modelo geométrico coinciden, demostrando la eficacia del modelo para describir el número de niños observados hasta encontrar uno con anemia grave. La coherencia en estos indicadores estadísticos respalda la validez de la aproximación geométrica en este contexto.

-   **Experimento**

Se quiere averiguar la probabilidad de que se necesite observar 100 niños o menos para encontrar uno con anemia grave.

$$
P(X \leq 100)
$$

```{r}

pgeom(100 - 1, p)
```

La probabilidad de que se necesite observar 100 niños o menos para encontrar uno con anemia grave es de aproximadamente 0.3082465.

### Número de madres con un determinado nivel educativo

```{r}
table(RECH5$nivel_educativo)
```

La variable "**Número de madres con un determinado nivel educativo**" es discreta, ya que cuenta con precisión cuántas madres se encuentran en cada categoría educativa (primaria, secundaria, universitaria, etc.). La discreción proviene de que los valores son enteros y específicos.

Tenemos los siguientes eventos:

**N**: Seleccionar a una madre que participó en la encuesta y que no haya recibido educación.

**P**: Seleccionar a una madre que participó en la encuesta y su nivel educativo máximo alcanzado es la primaria.

**S**: Seleccionar a una madre que participó en la encuesta y su nivel educativo máximo alcanzado es secundaria.

**U**: Seleccionar a una madre que participó en la encuesta y su nivel educativo máximo alcanzado es la superior.

Vamos a tomar el evento **S** como nuestro éxito.

```{r}

N <- 451
P <- 7357
S <- 23642
U <- 4918

Total_E <- N + P + S + U

PN <- N / Total_E
PP <- P / Total_E
PS <- S / Total_E
PU <- U / Total_E

cat("Probabilidad de no educación (PN):", PN, "\n")
cat("Probabilidad de educación primaria (PP):", PP, "\n")
cat("Probabilidad de educación secundaria (PS):", PS, "\n")
cat("Probabilidad de educación superior (PU):", PU, "\n")
```

La probabilidad de que ocurra el éxito (**S**):

$$
P(S) = 0.65
$$

-   **Definimos nuestra variable aleatoria discreta**

**X**: Número de madres cuyo mayor nivel educativo alcanzado sea la secundaria en una muestra sin reemplazo de 100.

-   **Vamos a utilizar el modelo hipergeométrico:**

$$
X \sim H(N,r,n)
$$

-   **Definimos parámetros**

**N**: Representa el total de mujeres que participaron en la encuesta.

**r**: Indica el número de mujeres cuyo nivel educativo máximo es la secundaria.

**n**: Es el número de elementos que seleccionaremos de este conjunto total.

Observemos una gráfica de distribución hipergeométrica en torno a los parámetros descritos y a nuestra variable aleatoria discreta '**X'** en una muestra de 100:

```{r}

n <- 100
r <- S
N <- Total_E

XX <- 0:100

plot(XX, dhyper(0:n, r, (N - r), n), type = "h", lwd = 2, col = "blue",
     ylab = "P(X = x)", xlab = "Número de estudiantes con educación secundaria en una muestra de 100",
     main = "Distribución Hipergeométrica",
     sub = paste("Total de estudiantes con educación secundaria:", S))
```

-   **Validamos las propiedades de esperanza, varianza, desviación estándar y coeficiente de variación**

```{r}

mu_e <- n * r / N
variance <- (n * r * (N - r) * (N - n)) / (N^2 * (N - 1))
sigma_e <- sqrt(variance)
cv <- sigma_e / mu_e


probabilities <- dhyper(0:n, r, (N - r), n)
sample_mean <- sum(probabilities * (0:n))
sample_variance <- sum(probabilities * (0:n - sample_mean)^2)
sample_sd <- sqrt(sample_variance)
sample_cv <- sample_sd / sample_mean

cat("Media teórica:", mu_e, "\n")
cat("Varianza teórica:", variance, "\n")
cat("Desviación estándar teórica:", sigma_e, "\n")
cat("Coeficiente de variación teórico:", cv, "\n")
cat("Media práctica:", sample_mean, "\n")
cat("Varianza práctica:", sample_variance, "\n")
cat("Desviación estándar práctica:", sample_sd, "\n")
cat("Coeficiente de variación práctico:", sample_cv, "\n")
```

Los resultados teóricos y prácticos en el modelo hipergeométrico coinciden, demostrando la eficacia del modelo para describir el número de niños observados hasta encontrar uno con anemia grave. La coherencia en estos indicadores estadísticos respalda la validez de la aproximación hipergeométrica en este contexto.

```{r}

plot(XX, dhyper(0:n, r, (N - r), n), type = "h", lwd = 2, col = "blue",
     ylab = "P(X = x)", xlab = "Número de estudiantes con educación secundaria en una muestra de 100",
     main = "Distribución Hipergeométrica",
     sub = paste("Total de estudiantes con educación secundaria:", S))


abline(v = mu_e, col = "red", lty = 2, lwd = 2)
abline(v = c(mu_e - sigma_e, mu_e + sigma_e), col = "black", lty = 3, lwd = 2)

legend("topleft", legend = c("Probabilidades", "Media", "Media ± 1 Desviación Estándar"),
       col = c("blue", "red", "black"), lty = c(1, 2, 3), lwd = 2)

cat("La línea roja representa la media teórica de la distribución hipergeométrica.\n")
cat("Las líneas verdes indican la media ± 1 desviación estándar.\n")
cat("Esto ayuda a visualizar la dispersión de la distribución.\n")
```

-   **Experimento**

Deseamos determinar la probabilidad de seleccionar al menos 50 mujeres cuyo nivel educativo máximo sea la secundaria de una muestra de 100 mujeres.

$$
P(X \geq 50)
$$

```{r}

phyper(50, r, N - r, n, lower.tail = F)
```

Dado el resultado, es altamente probable encontrar en esta muestra de tamaño reducido a más de 50 mujeres cuyo máximo nivel educativo fue la secundaria. Esto se debe a la alta probabilidad del evento **S** (**0.65**).

## Variables aleatorias continuas

### Hemoglobina ajustada en función de la latitud ($g/dl$)

```{r}

unique(RECH5$hemoglobina_ajustada_latitud)
```

La continuidad de esta variable se relaciona con la naturaleza de la medición. En un contexto práctico, los niveles de hemoglobina pueden variar de manera suave y gradual, y no se limitan a valores discretos específicos. La posibilidad de tener un número infinito de valores en cualquier rango dado hace que la hemoglobina sea una variable continua.

-   **Validamos las propiedades de esperanza, varianza, desviación estándar y coeficiente de variación**

```{r}

esperanza <- mean(RECH5$hemoglobina_ajustada_latitud)

varianza <- var(RECH5$hemoglobina_ajustada_latitud)

desviacion_estandar <- sd(RECH5$hemoglobina_ajustada_latitud)

coeficiente_variacion <- desviacion_estandar / esperanza

cat("Esperanza (media):", esperanza, "\n")
cat("Varianza:", varianza, "\n")
cat("Desviación estándar:", desviacion_estandar, "\n")
cat("Coeficiente de variación:", coeficiente_variacion, "\n")
```

1.  **Esperanza (media): 12.68532:** El promedio de los niveles de hemoglobina en la muestra es aproximadamente 12.69 $g/dl$. Esto da una idea general de cuál podría ser el nivel "típico" de hemoglobina en la población estudiada.

2.  **Varianza: 1.613424:** Mide cuánto varían los niveles de hemoglobina alrededor de la media. En este conjunto de datos, la variabilidad es moderada, lo que significa que los niveles de hemoglobina no son todos iguales, pero tampoco están muy dispersos.

3.  **Desviación estándar: 1.270206:** La desviación estándar es una medida de cuánto se espera que los niveles de hemoglobina varíen respecto a la media. Con una desviación estándar de 1.27 $g/dl$, podemos decir que la mayoría de los valores de hemoglobina están a una distancia relativamente cercana del promedio.

4.  **Coeficiente de variación: 0.100132:** Este número (10%) proporciona una perspectiva relativa de la variabilidad en comparación con el promedio. Un coeficiente de variación bajo sugiere que la variabilidad en los niveles de hemoglobina no es muy alta en relación con la media, lo que implica cierta consistencia en los resultados.

-   **Identificamos la distribución**

**Primero**, generamos un histograma y un gráfico de densidad kernel para obtener una visión integral de la distribución de los datos y comprender mejor su comportamiento.

```{r}

hist(RECH5$hemoglobina_ajustada_latitud, breaks= 50, main = "Histograma de Hemoglobina", xlab = "Hemoglobina", col = "lightblue", border = "black")

plot(density(RECH5$hemoglobina_ajustada_latitud), main = "Gráfico de densidad de Kernel")
```

**Segundo**, utilizamos la biblioteca **`rriskDistributions`** para realizar ajustes de distribuciones continuas a los datos de la variable **`hemoglobina_ajustada_latitud`** almacenados en el vector **`x`**. Luego, visualizamos los datos utilizando la función **`View(x)`** y procedemos a realizar el ajuste con la función **`fit.cont(x)`**.

```{r}

library(rriskDistributions)

x <- RECH5$hemoglobina_ajustada_latitud

View(x)

fit.cont(x)
```

Los resultados del ajuste indican que la distribución de los datos se asemeja más a una distribución normal. Esta conclusión encuentra respaldo en la forma del gráfico de densidad de kernel, el cual exhibía una configuración similar a la característica campana asociada a la distribución normal.

-   **Vamos a utilizar el modelo de distribución normal:**

$$ X \sim N(\mu,\sigma^2
) $$

-   **Definimos parámetros**

$\mu$ : Es el valor de la media de la variable.

$\sigma^2$ : Es el valor de la varianza de la variable.

Observemos una gráfica de distribución normal en torno a los parámetros descritos:

```{r}

mu_h <- 12.685317
sigma_h <- 1.270189

hist(RECH5$hemoglobina_ajustada_latitud,
     breaks = 50,
     freq = FALSE,
     main = "Histograma de hemoglobina",
     xlab = "Hemoglobina (g/dl)",
     col = "#66c2a5",
     border = "#333333")

lines(density(RECH5$hemoglobina_ajustada_latitud,
              na.rm = TRUE),
      col = "#fc8d62",
      lwd = 3)

ylim <- c(0,
          max(density(RECH5$hemoglobina_ajustada_latitud,
                      na.rm=TRUE)$y))

lines(density(RECH5$hemoglobina_ajustada_latitud,
              na.rm = TRUE),
      col = "#fc8d62",
      lwd = 3)

curve(dnorm(x,
            mu_h,
            sigma_h),
      lwd = 2,
      col = "#000000",
      add = TRUE)

legend("topleft",
       c("Curva observada (kernel)",
         "Curva teórica (normal)"),
       lty = 1,
       lwd = 2,
       col = c("#fc8d62",
               "black"),
       bty = "n",
       cex = 0.8)
```

-   **Definimos nuestra variable aleatoria continua**

**X**: Nivel de hemoglobina en $g/dl$ de una madre encuestada.

-   **Experimento**

Probabilidad de que una madre tenga menos de 12 $g/dl$ hemoglobina.

$$
P(X < 12)
$$

```{r}

pnorm(12, mu_h,  sigma_h)
```

La probabilidad de que una madre tenga 12 $g/dl$ o menos de hemoglobina, según el resultado proporcionado (0.2947574), indica que hay una probabilidad relativamente baja de que una madre seleccionada al azar tenga una concentración de hemoglobina de 12 $g/dl$ o inferior, según la distribución normal ajustada a los datos.

Escogimos ese rango de hemoglobina debido a que es el rango en el que empieza la anemia. Por lo tanto, esperamos que sea cercano a lo siguiente:

```{r}

table(RECH5$anemia)
```

```{r}

Madres_con_anemia <- 7142 + 978 + 83
Total <- 7142 + 978 + 83 + 28165

Madres_con_anemia / Total
```

Los resultados se aproximan.

### Peso ($kg$)

```{r}

unique(RECH5$peso)
```

La naturaleza continua de la variable de peso se relaciona directamente con la forma en que se mide. En un contexto práctico, los valores de peso pueden variar de manera suave y gradual, extendiéndose a lo largo de un rango continuo. A diferencia de las medidas discretas, como contar el número de elementos, el peso tiene la capacidad de tomar un número infinito de valores en cualquier intervalo dado.

-   **Validamos las propiedades de esperanza, varianza, desviación estándar y coeficiente de variación**

```{r}

esperanza <- mean(RECH5$peso)

varianza <- var(RECH5$peso)

desviacion_estandar <- sd(RECH5$peso)

coeficiente_variacion <- desviacion_estandar / esperanza

cat("Esperanza (media):", esperanza, "\n")
cat("Varianza:", varianza, "\n")
cat("Desviación estándar:", desviacion_estandar, "\n")
cat("Coeficiente de variación:", coeficiente_variacion, "\n")

```

1.  **Esperanza (62.72915):** La esperanza, también conocida como la media, representa el valor promedio de la variable. En este contexto, la esperanza de 62.72915 sugiere que, en promedio, el peso de la población está alrededor de 62.73 unidades.

2.  **Varianza (176.5763)**: La varianza mide cuánto se dispersan los valores de la variable respecto a su media. Una varianza más alta indica mayor dispersión. En este caso, una varianza de 176.5763 implica que hay cierta variabilidad en los pesos de la población alrededor de la media.

3.  **Desviación estándar (13.2882):** La desviación estándar es simplemente la raíz cuadrada de la varianza. Es una medida de la dispersión de los datos. En este contexto, una desviación estándar de 13.2882 indica cuánto suelen variar individualmente los pesos de la población con respecto a la media.

4.  **Coeficiente de variación (0.2118346):** El coeficiente de variación es la proporción entre la desviación estándar y la media, expresado como un porcentaje. Mide la variabilidad relativa de la variable respecto a su media. En este caso, un coeficiente de variación del 21.18% indica que la variabilidad relativa del peso con respecto a la media es del 21.18%, lo cual proporciona una perspectiva de la dispersión relativa en comparación con la media.

-   **Identificamos la distribución**

**Primero**, generamos un histograma y un gráfico de densidad kernel para obtener una visión integral de la distribución de los datos y comprender mejor su comportamiento.

```{r}

hist(RECH5$peso,
     breaks= 50,
     main = "Histograma de Hemoglobina",
     xlab = "Hemoglobina", 
     col = "lightblue",
     border = "black")

plot(density(RECH5$peso),
     main = "Gráfico de densidad de Kernel")
```

**Segundo**, utilizamos la biblioteca **`rriskDistributions`** para realizar ajustes de distribuciones continuas a los datos de la variable **`hemoglobina_ajustada_latitud`** almacenados en el vector **`x`**. Luego, visualizamos los datos utilizando la función **`View(x)`** y procedemos a realizar el ajuste con la función **`fit.cont(x)`**.

```{r}

library(rriskDistributions)

x <- RECH5$peso

View(x)

fit.cont(x)
```

Los resultados del ajuste indican que la distribución de los datos se asemeja más a una distribución normal. Esta conclusión encuentra respaldo en la forma del gráfico de densidad de kernel, el cual exhibía una configuración similar a la característica campana asociada a la distribución normal.

-   **Vamos a utilizar el modelo de distribución normal:**

$$ X \sim N(\mu, \; \sigma^2 ) $$

-   **Definimos parámetros**

$\mu$ : Es el valor de la media de la variable.

$\sigma^2$ : Es el valor de la varianza de la variable.

Observemos una gráfica de distribución normal en torno a los parámetros descritos:

```{r}

mu_p <- 62.72915
sigma_p <- 13.28802

hist(RECH5$peso,
     breaks = 50,
     freq = FALSE,
     main = "Histograma de peso",
     xlab = "Peso (kg)",
     col = "#66c2a5",
     border = "#333333")

lines(density(RECH5$hemoglobina_ajustada_latitud, na.rm = TRUE),
      col = "#fc8d62",
      lwd = 3)

ylim <- c(0, max(density(RECH5$peso,
                         na.rm = TRUE)$y))

lines(density(RECH5$peso, na.rm = TRUE),
      col = "#fc8d62",
      lwd = 3)

curve(dnorm(x, mu_p, sigma_p),
      lwd = 2,
      col = "#000000",
      add = TRUE)

legend("topright",
       c("Curva observada (kernel)", "Curva teórica (normal)"),
       lty = 1,
       lwd = 2,
       col = c("#fc8d62", "#8da0cb"),
       bty = "n",
       cex = 0.8)
```

-   **Definimos nuestra variable aleatoria continua**

$X$: Peso en $kg$ de una madre encuestada.

-   **Experimento**

Probabilidad de que una madre pese más de 70 $kg$.

$$
P(X > 70)
$$

```{r}

pnorm(70, mu_p,  sigma_p, lower.tail =  F)
```

La probabilidad de que una madre pese más de 70 $kg$, según el resultado proporcionado (0.2921298), indica que hay una probabilidad relativamente baja de que una madre seleccionada al azar tenga un peso de más de 70 $kg$, según la distribución de la variable aleatoria continua ajustada a los datos. Este resultado sugiere que la mayoría de las madres encuestadas tienen un peso inferior a 70 $kg$ según la distribución de la muestra analizada.

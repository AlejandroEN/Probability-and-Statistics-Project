---
title: "Anemia en infantes y madres"
format: html
editor: visual
---

![](UTEC.png){fig-align="left" width="252"}

# [Análisis de los casos de anemia en infantes y mujeres de 12 a 49 años en el Perú en el año 2022]{.underline}

## Introducción

### Contexto

En el mes de mayo del año 2022, se llevó a cabo en nuestro país la Encuesta Demográfica y de Salud Familiar, un estudio que recopiló datos de una muestra representativa de viviendas en todo el territorio peruano. Este estudio se basó en tres cuestionarios diseñados específicamente: uno dirigido a todos los miembros de cada hogar, otro enfocado en mujeres cuyas edades se encontraban en el rango de 12 a 49 años, y un tercero destinado a individuos de 15 años o más.

En el contexto de esta encuesta, se solicitó a los residentes de los hogares su participación en una evaluación destinada a conocer sus niveles de hemoglobina en la sangre, a la que podían optar por unirse o no.

La totalidad de la información recopilada en esta encuesta se encuentra disponible para consulta por parte de cualquier ciudadano en la base de datos del Instituto Nacional de Estadística e Informática (INEI). Los datos se presentan organizados en módulos temáticos, y nuestro enfoque recae en los análisis de los casos de anemia en infantes y mujeres.

### Relevancia

La anemia es un problema de salud pública de gran relevancia en nuestro país. La falta de hemoglobina en la sangre puede tener consecuencias graves, especialmente en niños y madres. Además, la anemia puede afectar el desarrollo físico y cognitivo de los niños y aumentar el riesgo de complicaciones en el embarazo para las madres; por lo tanto, comprender la prevalencia y severidad de la anemia en estos grupos es esencial para abordar adecuadamente este problema de salud en el país.

### Objetivos

-   Describir los casos de anemia y su severidad en niños y mujeres en el Perú en el año 2022.

-   Analizar el índice de anemia en las diversas regiones del Perú en el año 2022.

-   Describir las características sociales de los grupos vulnerables (niños y mujeres) a la anemia en el Perú en el año 2022.

### Planificación

La forma en que nos organizamos en hacer este proyecto se puede visualizar en este diagrama de Gantt:

![](gantt.png)

Este diagrama fue realizado con el siguiente código:

```{r, warning=FALSE, results=FALSE}

library(DiagrammeR)

mermaid("gantt
        dateFormat  YYYY-MM-DD
        title Diagrama de Gantt
        
        section Main things
        Preparar PG01:first_1,2023-04-15, 3d
        Entrega PG01:first_2,2023-04-18, 2d
        Preparar PG02:first_3,2023-04-20, 11d
        Entrega PG02:first_4,2023-05-01, 2d
        Preparar PG03:first_5,2023-05-03, 21d
        Entrega PG03:first_6,2023-05-24, 2d
        Informe PG1:first_7,2023-05-26, 9d
        Entrega Informe:first_8, 2023-06-04,1d
        
        section PG01
        Diagrama de Gantt:first_1, 2023-04-15, 12h
        Delimitar tema:first_2, after first_1, 12h
        Variables de analisis: first_3, after first_2, 6h
        Limpieza de la base de datos: first_4, after first_2, 12h
        Analizar la factibilidad: first_5, after first_3, 1d
        
        section PG02
        Replantear objetivos:first_6, 2023-04-20, 1d
        Limpieza de tablas:first_7, after first_6, 5d
        Corrección de variables:first_8, after first_7, 5d
        
        section PG03
        Análisis univariado:first_9, 2023-05-03, 12d
        Análisis bivariado:first_10, 2023-05-10, 10d
        Análisis multivariado:first_11, 2023-05-15, 7d
        Escribir análisis:first_12, after first_11, 2d
        
        section Informe PG1
        Correcciones:first_13, 2023-05-26, 3d
        Union de PG0x:first_14, after first_13, 2d
        Verificar ortografía:first_15, after first_14, 2d
        Informe prolijo:first_16, after first_15, 2d
        ")
```

## Datos

En esta sección, detallaremos cómo se llevaron a cabo la recolección de datos, la definición de la población y muestra, así como la explicación de las variables de estudio. Además, se proporcionará una visión general de la limpieza de datos realizada.

### Recolección de datos

Los datos para este estudio se obtuvieron a partir de la Encuesta Demográfica y de Salud Familiar realizada en mayo de 2022 en el Perú.

Para nuestra investigación, accedimos a la base de datos del Instituto Nacional de Estadística e Informática (INEI) que contenía la información recopilada en esta encuesta. Se seleccionaron módulos específicos que eran relevantes para nuestro estudio sobre la anemia en niños y madres. Estos módulos incluían información sobre las características de los hogares y sus integrantes. El acceso a esta base de datos nos proporcionó una amplia cantidad de información relevante y detallada para nuestros objetivos de investigación.

### Población objetivo, muestra y muestreo

-   **Población:** Son los integrantes del total de viviendas obtenida de los Censos Nacionales 2017: XII de Población y VII de Vivienda y III de Comunidades Indígenas, en el que se registro que en el Perú hay un total de 10 millones 102 mil 849 viviendas particulares.

-   **Muestra:** Se tomaron 36650 del total de viviendas.

-   **Muestreo:** El muestreo ha sido probabilístico por conglomerados.

### FALTA - Variables (incompleto)

|  Nombre  | Descripción |        Restricción        | Tipo de variable |
|:--------:|:-----------:|:-------------------------:|:----------------:|
| Variable |   Estrato   | Áreas densamente pobladas |       Tipo       |
| Variable |   Estrato   | Áreas densamente pobladas |       Tipo       |
| Variable |   Estrato   | Áreas densamente pobladas |       Tipo       |
| Variable |   Estrato   | Áreas densamente pobladas |       Tipo       |
| variable |   Estrato   | Áreas densamente pobladas |       Tipo       |

### Carga de librerías y *datasets*

Primero cargamos las librerías necesarias para trabajar

```{r message=FALSE}

library(readr)
library(dplyr)
library(ggplot2)
library(gt)
```

Cargamos también los datasets.

```{r, message=FALSE}

REC91_raw <- read_csv("REC91.csv")
REC0111_raw <- read_csv("REC0111.csv")
RECH5_raw <- read_csv("RECH5.csv")
REC44_raw <- read_csv("REC44.csv")
RECH23_raw <- read_csv("RECH23.csv")
RECH0_raw <- read_csv("RECH0.csv")
```

### Resumen de datos y obtención de variables pertinentes

Realizaremos un resumen de los datos de cada tabla y, además, comenzaremos con nuestro primer criterio de exclusión: seleccionaremos solo las variables pertinentes para nuestro estudio.

#### Tabla RECH0 - Características del hogar

```{r}
summary(RECH0_raw)
```

Seleccionamos las variables pertinentes en nuestro análisis, les cambiamos de nombres y, de ser necesario, cambiamos el tipo de dato.

```{r}
RECH0 <- select(RECH0_raw, HHID, HV009, HV015)

RECH0 <- rename(RECH0,
                cuestionario_hogar_id = HHID,
                personas_en_el_hogar = HV009,
                estado_entrevista = HV015)

RECH0$cuestionario_hogar_id <- as.character(RECH0$cuestionario_hogar_id)
RECH0$estado_entrevista <- as.character(RECH0$estado_entrevista)

str(RECH0)
```

#### Tabla REC0111 - Datos básicos del MEF

Relación entre identificación del cuestionario individual e identificación del cuestionario del hogar.

```{r}
summary(REC0111_raw)
```

Seleccionamos las variables pertinentes en nuestro análisis, les cambiamos de nombres y, de ser necesario, cambiamos el tipo de dato.

```{r}
REC0111 <- select(REC0111_raw, CASEID, HHID, V015, V024, V102)

REC0111 <- rename(REC0111,
                  cuestionario_individual_id = CASEID,
                  cuestionario_hogar_id = HHID,
                  estado_entrevista = V015,
                  region = V024,
                  tipo_de_residencia = V102)

REC0111$cuestionario_individual_id <- as.character(REC0111$cuestionario_individual_id)
REC0111$cuestionario_hogar_id <- as.character(REC0111$cuestionario_hogar_id)
REC0111$region <- as.character(REC0111$region)
REC0111$tipo_de_residencia <- as.character(REC0111$tipo_de_residencia)

region_names <- c("1" = "Amazonas", "2" = "Ancash", "3" = "Apurimac", "4" = "Arequipa", 
                  "5" = "Ayacucho", "6" = "Cajamarca", "7" = "Callao", "8" = "Cusco", 
                  "9" = "Huancavelica", "10" = "Huanuco", "11" = "Ica", "12" = "Junin",
                  "13" = "La Libertad", "14" = "Lambayeque", "15" = "Lima",
                  "16" = "Loreto", "17" = "Madre de Dios", "18" = "Moquegua",
                  "19" = "Pasco",  "20" =  "Piura",  "21"  =  "Puno",
                  "22"  =  "San Martin",  "23"  =  "Tacna",
                  "24"  =  "Tumbes",  "25"  =  "Ucayali")

REC0111$region <- region_names[as.character(REC0111$region)]

str(REC0111)
```

Asignamos la categoría que corresponde a cada número para la variable *tipo de residencia*.

```{r}
REC0111$tipo_de_residencia[REC0111$tipo_de_residencia %in% c(1)] <- "urbano"
REC0111$tipo_de_residencia[REC0111$tipo_de_residencia %in% c(2)] <- "rural"
```

#### Tabla RECH5 - Peso y talla (anemia)

Características de las mujeres de 12 a 49 años.

```{r}
summary(RECH5_raw)
```

Seleccionamos las variables pertinentes en nuestro análisis, les cambiamos de nombres y, de ser necesario, cambiamos el tipo de dato.

```{r}
RECH5 <- select(RECH5_raw, HHID, HA1, HA2, HA3, HA13, HA53, HA54, HA55, HA56, HA57, HA66)

RECH5 <- rename(RECH5,
                cuestionario_individual_id = HHID,
                edad = HA1,
                peso = HA2,
                talla = HA3,
                estado_medicion = HA13,
                hemoglobina = HA53,
                is_embarazada = HA54,
                estado_medicion_hemoglobina = HA55,
                hemoglobina_ajustada_latitud = HA56,
                anemia = HA57,
                nivel_educativo = HA66)

RECH5$estado_medicion <- as.character(RECH5$estado_medicion)
RECH5$is_embarazada <- as.character(RECH5$is_embarazada)
RECH5$estado_medicion_hemoglobina <- as.character(RECH5$estado_medicion_hemoglobina)
RECH5$anemia <- as.character(RECH5$anemia)
RECH5$nivel_educativo <- as.character(RECH5$nivel_educativo)

str(RECH5)
```

Asignamos la categoría que corresponde a cada número para la variable *anemia*.

```{r}
RECH5$anemia[RECH5$anemia %in% c(1)] <- "3.grave"
RECH5$anemia[RECH5$anemia %in% c(2)] <- "2.moderado"
RECH5$anemia[RECH5$anemia %in% c(3)] <- "1.leve"
RECH5$anemia[RECH5$anemia %in% c(4)] <- "0.sin_anemia"
```

Asignamos la categoría que corresponde a cada número para la variable *nivel_educativo*.

```{r}
RECH5$nivel_educativo[RECH5$nivel_educativo %in% c(0)] <- "0.sin_educacion"
RECH5$nivel_educativo[RECH5$nivel_educativo %in% c(1)] <- "1.primaria"
RECH5$nivel_educativo[RECH5$nivel_educativo %in% c(2)] <- "2.secundaria"
RECH5$nivel_educativo[RECH5$nivel_educativo %in% c(3)] <- "3.superior"
RECH5$nivel_educativo[RECH5$nivel_educativo %in% c(8)] <- "no_sabe"
```

Asignamos la categoría que corresponde a cada número de la variable is_embarazada.

```{r}
RECH5$is_embarazada[RECH5$is_embarazada %in% c(1)] <- "embarazada"
RECH5$is_embarazada[RECH5$is_embarazada %in% c(0)] <- "no embarazada"
```

Cambiamos las unidades de *talla* y *peso*.

```{r}
RECH5 <- mutate(RECH5,
                # Convertimos de centímetros a metros
                talla = talla / 10,
                # Convertimos de gramos a kilogramos
                peso = peso / 10)
```

#### Tabla REC44 - Peso y talla (anemia)

Características de los infantes de 0 a 59 meses (5 años aproximadamente) seleccionados por hogar.

```{r}
summary(REC44_raw)
```

Seleccionamos las variables pertinentes en nuestro análisis, les cambiamos de nombres y, de ser necesario, cambiamos el tipo de dato.

```{r}
REC44 <- select(REC44_raw, CASEID, HW1, HW2, HW3, HW13, HW53, HW55, HW56, HW57)

REC44 <- rename(REC44,
                cuestionario_individual_id = CASEID,
                edad = HW1,
                peso = HW2,
                talla = HW3,
                estado_medicion = HW13,
                hemoglobina = HW53,
                estado_medicion_hemoglobina = HW55,
                hemoglobina_ajustada_latitud = HW56,
                anemia = HW57)

REC44$estado_medicion <- as.character(REC44$estado_medicion)
REC44$estado_medicion_hemoglobina <- as.character(REC44$estado_medicion_hemoglobina)
REC44$anemia <- as.character(REC44$anemia)

str(REC44)
```

Asignamos la categoría que corresponde a cada número para la variable *anemia*.

```{r}
REC44$anemia[REC44$anemia %in% c(1)] <- "3.grave"
REC44$anemia[REC44$anemia %in% c(2)] <- "2.moderado"
REC44$anemia[REC44$anemia %in% c(3)] <- "1.leve"
REC44$anemia[REC44$anemia %in% c(4)] <- "0.sin_anemia"
```

Cambiamos las unidades de *talla* y *peso*.

```{r}
REC44 <- mutate(REC44,
                # Agregamos el decimal mencionado en el diccionario.
                talla = talla / 10,
                # Agregamos el decimal mencionado en el diccionario.
                peso = peso / 10)
```

#### Tabla RECH23 - Características del hogar de los participantes

Estos contienen las características del modo de vida de los que respondieron la encuesta.

```{r}
RECH23 <- select(RECH23_raw, HHID, HV201, HV270)

RECH23 <- rename(RECH23,
                cuestionario_hogar_id = HHID,
                indice_riqueza = HV270)
RECH23$cuestionario_hogar_id <- as.character(RECH23$cuestionario_hogar_id)
RECH23$indice_riqueza <- as.character(RECH23$indice_riqueza)
str(RECH23)
```

Asignamos la categoría que corresponde a cada número para la variable *indice_riqueza (hv270)*

```{r}
RECH23$indice_riqueza[RECH23$indice_riqueza %in% c(1)] <- "1.muy_pobre"
RECH23$indice_riqueza[RECH23$indice_riqueza %in% c(2)] <- "2.pobre"
RECH23$indice_riqueza[RECH23$indice_riqueza %in% c(3)] <- "3.medio"
RECH23$indice_riqueza[RECH23$indice_riqueza %in% c(4)] <- "4.rico"
RECH23$indice_riqueza[RECH23$indice_riqueza %in% c(5)] <- "5.muy_rico"
```

### Limpieza de datos

Vamos a descartar las observaciones que no tengan información.

#### RECH0

En este dataset se encuentra un atributo que determina el si se realizo la entrevista en el hogar seleccionado o no, siendo la opcion 1 que si esta completada. Vamos a requerir las encuestas completadas.

```{r}
RECH0 <- filter(RECH0, estado_entrevista == 1)
```

#### REC0111

En este dataset también se encuentran el estado de las entrevistas, donde el valor 1 significa que esta completada.

```{r}
REC0111 <- filter(REC0111, estado_entrevista == 1)
```

#### RECH5

Realizamos un filtro en función de la variable *estado_medicion* y *estado_medicion_hemoglobina,* en donde el valor 0 significa que si se completo la medición de cada uno.

Existe un valor que rellena los espacios de ciertos atributos debido a que, aun por aceptar ser parte de una medición, no se cumplió, y cuyo espacio se llena con el máximo número que se puede tomar con la cantidad máxima de dígitos disponibles que toma el atributo. Estos los vamos a filtrar con *talla*, que al contener el valor no considerado (999 para la ocasión), da señal que la medición general al final no se pudo tomar. También se va a cambiar el valor de la hemoglobina y hemoglobina ajustada para que se encuentren en la magnitud de gramos de hemoglobina por decilitro, además de filtrar a los atributos que aun presenten datos faltantes.

```{r}
RECH5 <- filter(RECH5, estado_medicion == 0)
RECH5 <- filter(RECH5, estado_medicion_hemoglobina == 0)

RECH5 <- RECH5 %>%
  mutate(
    talla = ifelse(talla >= 999, NA, talla),
    hemoglobina = hemoglobina / 10,  # Convertir 'hemoglobina' a una escala razonable
    hemoglobina_ajustada_latitud = hemoglobina_ajustada_latitud / 10  # Convertir 'hemoglobina' a una escala razonable
  ) %>% na.omit()

# Verificar el resumen del marco de datos después de las transformaciones

summary(RECH5)
```

### REC44

Realizamos un filtro en función de la variable *estado_medicion* y *estado_medicion_hemoglobina.*

Convertimos 'hemoglobina' y 'hemoglobina_ajustada_latitud' a una escala razonable.

```{r}
REC44 <- filter(REC44, estado_medicion == 0)
REC44 <- filter(REC44, estado_medicion_hemoglobina == 0)

REC44 <- REC44 %>%
  mutate(
    hemoglobina = hemoglobina / 10, 
    hemoglobina_ajustada_latitud = hemoglobina_ajustada_latitud / 10  
  )

summary(REC44)
```

#### RECH23

Filtramos a las filas donde los hogares no participaron, tomando a una variable cualquiera y filtrando su fila si su espacio esta vacío o no.

```{r}
RECH23 <- filter(RECH23, !is.na(indice_riqueza))
str(RECH23)
```

## [Análisis descriptivo]{.underline}

### [Análisis univariado]{.underline}

#### Anemia en niños

Promedio de edad, talla, peso y hemoglobina en niños con anemia leve, moderada y grave.

```{r}
niños_anemia_leve = filter(REC44, anemia == "1.leve")
niños_anemia_moderada = filter(REC44, anemia == "2.moderado")
niños_anemia_grave = filter(REC44, anemia == "3.grave")

niños_promedios_anemia_leve <- data.frame(colMeans(niños_anemia_leve[, sapply(niños_anemia_leve, is.numeric)]))
niños_promedios_anemia_moderada <- data.frame(colMeans(niños_anemia_moderada[, sapply(niños_anemia_moderada, is.numeric)]))
niños_promedios_anemia_grave <- data.frame(colMeans(niños_anemia_grave[, sapply(niños_anemia_grave, is.numeric)]))

print(niños_promedios_anemia_leve)
print(niños_promedios_anemia_moderada)
print(niños_promedios_anemia_grave)
```

#### Anemia en madres

Promedio de edad, talla, peso y hemoglobina en madres con anemia leve, moderada y grave.

```{r}
madres_anemia_leve = filter(RECH5, anemia == "1.leve")
madres_anemia_moderada = filter(RECH5, anemia == "2.moderado")
madres_anemia_grave = filter(RECH5, anemia == "3.grave")

madres_promedios_anemia_leve <- data.frame(colMeans(madres_anemia_leve[, sapply(madres_anemia_leve, is.numeric)]))
madres_promedios_anemia_moderada <- data.frame(colMeans(madres_anemia_moderada[, sapply(madres_anemia_moderada, is.numeric)]))
madres_promedios_anemia_grave <- data.frame(colMeans(madres_anemia_grave[, sapply(madres_anemia_grave, is.numeric)]))

print(madres_promedios_anemia_leve)
print(madres_promedios_anemia_moderada)
print(madres_promedios_anemia_grave)
```

Análisis de las tablas. Se obtuvo el promedio de datos de los participantes por su nivel de anemia. Esto nos da una idea de por qué valores de edad, talla, peso y hemoglobina se puede encontrar un caso de anemia en estado leve, moderado o grave.

### [Análisis de interacción]{.underline}

Analizaremos la relación entre el tipo de residencia y el nivel de anemia de los niños.

```{r}
niños_anemia <- bind_rows(niños_anemia_leve, niños_anemia_moderada, niños_anemia_grave)

niños <- inner_join(REC0111, niños_anemia, by = "cuestionario_individual_id")

tabla_niños_residencia <- table(niños$tipo_de_residencia, niños$anemia)

tabla_niños_residencia 

```

```{r}

Tipo_de_Residencia_vs_Nivel_de_Anemia <- as.data.frame((tabla_niños_residencia/rowSums(tabla_niños_residencia))*100)

colnames(Tipo_de_Residencia_vs_Nivel_de_Anemia) <- c("tipo_de_residencia", "anemia", "frecuencia")

Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia <- as.factor(Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia)
Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia <- recode(Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia, 
                                `1` = "Urbano", 
                                `2` = "Rural")
Tipo_de_Residencia_vs_Nivel_de_Anemia$anemia <- as.factor(Tipo_de_Residencia_vs_Nivel_de_Anemia$anemia)


ggplot(Tipo_de_Residencia_vs_Nivel_de_Anemia, aes(x = tipo_de_residencia, y = frecuencia, fill = anemia)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Tipo de Residencia", y = "Frecuencia", fill = "Nivel de Anemia en niños") +
  theme_minimal()
```

```{r}

Tipo_de_Residencia_vs_Nivel_de_Anemia <- data.frame(
  tipo_de_residencia = c(1, 2),
  grave = c(14, 13),
  leve = c(3223, 1891),
  moderado = c(1232, 967)
)

Tipo_de_Residencia_vs_Nivel_de_Anemia$total <- rowSums(Tipo_de_Residencia_vs_Nivel_de_Anemia[,2:4])

Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia <- as.factor(Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia)
Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia <- recode(Tipo_de_Residencia_vs_Nivel_de_Anemia$tipo_de_residencia, 
                                `1` = "Urbano", 
                                `2` = "Rural")

gt(Tipo_de_Residencia_vs_Nivel_de_Anemia) %>%
  tab_header(
    title = "Tabla de Contingencia",
    subtitle = "Tipo de Residencia vs Nivel de Anemia"
  ) %>%
  cols_label(
    tipo_de_residencia = "Tipo de Residencia",
    grave = "Grave",
    leve = "Leve",
    moderado = "Moderado",
    total = "Total"
  ) %>%
  fmt_number(
    columns = vars(grave, leve, moderado, total),
    decimals = 0
  )

```

Como podemos observar, la proporción entre los distintos tipos de anemia es bastante similar sea el tipo de residencia urbano o rural.

Se hará la visión de casos de anemia por región del Perú.

```{r}

Region_vs_Nivel_de_Anemia <- data.frame(
  Region = c("Amazonas", "Ancash", "Apurimac", "Arequipa", 
             "Ayacucho", "Cajamarca", "Callao", "Cusco", 
             "Huancavelica", "Huanuco", "Ica", "Junin",
             "La Libertad", "Lambayeque", "Lima",
             "Loreto", "Madre de Dios", "Moquegua",
             "Pasco",  "Piura",  "Puno",
             "San Martin",  "Tacna",
             "Tumbes",  "Ucayali"),
  
  Leve = c(191,182,211,139,233,164,157,168,202,219,130,187,140,155,521,
           325,241,101,199,165,215,218,106,
           214 ,331),
  
  Moderado = c(83 ,66 ,82 ,36 ,96 ,47 ,57 ,102 ,155 ,115 ,44 ,75 ,59 ,48 ,162 ,
                173 ,107 ,27 ,118 ,60 ,125 ,79 ,
                46 ,57 ,180),

  Grave = c(0, 0, 0, 0, 3, 0, 0, 0, 1, 7, 1, 0, 2, 1, 0, 2, 0, 0, 5, 0, 4, 0, 1, 0, 0)

 
)

Region_vs_Nivel_de_Anemia$Total <- rowSums(Region_vs_Nivel_de_Anemia[,2:4])

gt(Region_vs_Nivel_de_Anemia) %>%
    tab_header(
        title = "Tabla de Contingencia",
        subtitle = "Region vs Nivel de Anemia"
    ) %>%
    cols_label(
        Region = "Region",
        Grave = "Grave",
        Moderado = "Moderado",
        Leve = "Leve",
        Total = "Total"
    ) %>%
    fmt_number(
        columns = vars(Grave, Leve,Moderado),
        decimals = 0
    )


```

```{r}

category_names <- c("Amazonas" = "Selva",
                    "Ancash" = "Sierra",
                    "Apurimac" = "Sierra",
                    "Arequipa" = "Costa",
                    "Ayacucho" = "Sierra",
                    "Cajamarca" = "Sierra",
                    "Callao" = "Costa",
                    "Cusco" = "Sierra",
                    "Huancavelica" = "Sierra",
                    "Huanuco" = 	"Sierra",
                    "Ica" = 	"Costa",
                    "Junin" = 	"Sierra",
                    "La Libertad" = 	"Costa",
                    "Lambayeque" = 	"Costa",
                    "Lima" = 	"Costa",
                    "Loreto" = 	"Selva",
                    "Madre de Dios" = 	"Selva",
                    "Moquegua" = 	"Costa",
                    "Pasco" = 	"Sierra",
                    "Piura" = 	"Costa",
                    "Puno" = 	"Sierra",
                    "San Martin" = 	"Selva",
                    "Tacna" = 	"Costa",
                    "Tumbes" = 	"Costa",
                    "Ucayali" = 	"Selva")

niños$Category <- category_names[niños$region]
REC0111$Category <- category_names[REC0111$region]
total_anemia <- table(niños$Category)

pie(total_anemia, main = "Total de niños con anemia por categoría", col = rainbow(length(total_anemia)))
```

En la distribución por regiones, Lima es la que tiene mayor cantidad de observaciones. Eso claramente por la cantidad de población que se concentra ahí.

En cuanto a separación por costa, sierra y selva, es en la sierra donde hay mas casos de anemia con poca diferencia con las demás.

```{r}
RECH5$cuestionario_individual_id <- sub("^0+", "", RECH5$cuestionario_individual_id)

Anemia_Riqueza_Madres <- merge(RECH5, RECH23, by.x = "cuestionario_individual_id", by.y = "cuestionario_hogar_id")


Anemia_Riqueza_Madres$indice_riqueza <- as.factor(Anemia_Riqueza_Madres$indice_riqueza)

Anemia_Riqueza_Madres$anemia <- as.factor(Anemia_Riqueza_Madres$anemia)

Riqueza_vs_Nivel_de_Anemia <- data.frame(
  Riqueza = c("Muy Pobre","Pobre", "Medio", "Rico", "Muy Rico"),
  

  Leve = c(193, 259, 100, 269, 157),
  
  Moderado = c(1327, 2461, 565, 1888, 900),
  
  Grave = c(17, 21, 11, 20, 14)
  

  
)

Riqueza_vs_Nivel_de_Anemia$Total <- rowSums(Riqueza_vs_Nivel_de_Anemia[,2:4])


gt(Riqueza_vs_Nivel_de_Anemia) %>%
    tab_header(
        title = "Tabla de Contingencia",
        subtitle = "Riqueza vs Nivel de Anemia en Madres"
    ) %>%
    cols_label(
        Riqueza = "Riqueza",
        Grave = "Grave",
        Moderado = "Moderado",
        Leve = "Leve",
        Total = "Total"
    ) %>%
    fmt_number(
        columns = vars(Grave, Moderado, Leve),
        decimals = 0
    )

Riqueza_vs_Nivel_de_Anemia$Porcentaje_Leve <- Riqueza_vs_Nivel_de_Anemia$Leve / Riqueza_vs_Nivel_de_Anemia$Total * 100
Riqueza_vs_Nivel_de_Anemia$Porcentaje_Moderado <- Riqueza_vs_Nivel_de_Anemia$Moderado / Riqueza_vs_Nivel_de_Anemia$Total * 100
Riqueza_vs_Nivel_de_Anemia$Porcentaje_Grave <- Riqueza_vs_Nivel_de_Anemia$Grave / Riqueza_vs_Nivel_de_Anemia$Total * 100

print(Riqueza_vs_Nivel_de_Anemia)

```

Gráfico donde se tomen las tres regiones con mas casos en infantes para luego compararlos.

```{r}
regiones_casos_infantes <- merge(REC0111, (select(REC44, anemia, cuestionario_individual_id))[REC44$anemia!="0.sin_anemia",], by= "cuestionario_individual_id")
regiones_casos_infantes_orden <- sort(table(regiones_casos_infantes$region), decreasing = TRUE)
tres_regiones_mas_casos_i <- head(regiones_casos_infantes_orden,3)
tres_regiones_mas_casos_i <- regiones_casos_infantes[(regiones_casos_infantes$region %in% names(tres_regiones_mas_casos_i)),]
tabla_tres_regiones_i <- (table(tres_regiones_mas_casos_i$region, tres_regiones_mas_casos_i$anemia))
```

```{r}
barplot(t(tabla_tres_regiones_i), col = 2:4, xlab="Regiones",
ylab="Nivel de anemia", ylim=c(0,1000), main="Distribución según
anemia y region")
legend("topright",legend=c("Leve","Moderado","Grave"),
col=2:4, cex= 1.0, pch=15,title="Nivel de anemia")
```

Hacemos el mismo proceso con las mujeres seleccionadas.

```{r}
regiones_casos_mujeres <- merge((select(RECH5, anemia, cuestionario_individual_id))[RECH5$anemia!="0.sin_anemia",], REC0111, by.x= "cuestionario_individual_id", by.y="cuestionario_hogar_id")
regiones_casos_mujeres_orden <- sort(table(regiones_casos_mujeres$region), decreasing = TRUE)
tres_regiones_mas_casos_m <- head(regiones_casos_mujeres_orden,3)
tres_regiones_mas_casos_m <- regiones_casos_mujeres[(regiones_casos_mujeres$region %in% names(tres_regiones_mas_casos_m)),]
tabla_tres_regiones_m <- table(tres_regiones_mas_casos_m$region, tres_regiones_mas_casos_m$anemia)
```

```{r}
barplot(t(tabla_tres_regiones_m), col = 2:4, xlab="Region",
ylab="Nivel de anemia", ylim=c(0,2000), main="Distribución según
anemia y region")
legend("topright",legend=c("Leve","Moderado","Grave"),
col=2:4, cex= 1.0, pch=15,title="Nivel de anemia")
```

Se nota que para ambos casos, siempre los casos leves son los predominantes.

La elección de las tres regiones con más casos es porque deben ser las regiones donde hay que preocuparse más en combatir a la enfermedad.

Boxplots entre hemoglobina e indice de riqueza con las mujeres

```{r}
ds_hemoglobina_riqueza <- merge((select(RECH5, hemoglobina, cuestionario_individual_id)), RECH23, by.x= "cuestionario_individual_id", by.y="cuestionario_hogar_id")
```

```{r}
boxplot(ds_hemoglobina_riqueza$hemoglobina ~ ds_hemoglobina_riqueza$indice_riqueza, xlab="Indice de riqueza", ylab="Nivel de hemoglobina (gr/dl)")
```

De todos los índices de riqueza, con los mas pobres es donde existe mayor dispersión. No hay mucha distinción en los casos bajos de hemoglobina por cada separación (que indica si presenta anemia).

# Probabilidades

Para esta parte vamos a usar nuestros conocimientos sobre probabilidades para trabajar con los eventos que seleccionamos.

### Probabilidad empírica

Primero, seleccionamos dos experimentos, determinando su espacio muestral y sus respectivas probabilidades.

**Experimento 1.** Escoger un hogar que aceptó participar en la encuesta y observar su nivel de riqueza.

**Espacio muestral (** $\Omega$ **).**

```{r}
unique(RECH23$indice_riqueza)
```

$$
\Omega = E1,E2,E3,E4, E5 
$$

Definición de eventos:

E1: Que se escoja un hogar cuyo indice de riqueza sea muy pobre

E2: Que se escoja un hogar cuyo indice de riqueza sea pobre

E3: Que se escoja un hogar cuyo indice de riqueza sea medio

E4: Que se escoja un hogar cuyo indice de riqueza sea rico

E5: Que se escoja un hogar cuyo indice de riqueza sea muy rico

**Probabilidad de cada evento:**

$$
P(x) = f(x)/n
$$\
f(x) = número de veces que se cumpla el evento en toda la muestra

n = tamaño de la muestra

```{r}
prob_riqueza <- table(RECH23$indice_riqueza)/sum(table(RECH23$indice_riqueza))
prob_riqueza
```

Comprobamos que todo sume uno (ya que son probabilidades de eventos atómicos en un espacio muestral $\Omega$ ).

```{r}
sum(table(RECH23$indice_riqueza)/sum(table(RECH23$indice_riqueza)))
```

Correspondiendo cada una con su respectiva probabilidad:

P(E1)=0.3151

P(E2)=0.251

P(E3)=0.1867

P(E4)=0.1395

Región con mayor y menor probabilidad de ser escogida.

```{r}
names(which.max(prob_riqueza))
names(which.min(prob_riqueza))
```

Al escoger un hogar para el experimento, es más probable que su nivel de riqueza sea muy pobre, y es menos probable que sea muy rico.

**Experimento 2.** Escoger un infante de los hogares que aceptaron participar en la prueba de hemoglobina y determinar su nivel de anemia.

**Espacio muestral(** $\Omega$ **).**

```{r}
unique(REC44$anemia)
```

$$
\Omega = E1,E2,E3,E4
$$

E1: Que se escoja un infante participante que no tenga anemia

E2: Que se escoja un infante participante cuyo nivel de anemia sea bajo

E3: Que se escoja un infante participante cuyo nivel de anemia sea moderado

E4: Que se escoja un infante participante cuyo nivel de anemia sea alto

**Probabilidad por evento:**

```{r}
prob_anemia <- table(REC44$anemia)/length(REC44$anemia)
prob_anemia
```

Comprobamos que todo sume uno.

```{r}
sum(table(REC44$anemia)/length(REC44$anemia))
```

Correspondiendo cada una con su respectiva probabilidad:

P(E1)=0.6322

P(E2)=0.2563

P(E3)=0.1102

P(E4)=0.0014

Nivel de anemia con mayor y menor probabilidad de ser escogida.

```{r}
names(which.max(prob_anemia))
names(which.min(prob_anemia))
```

Por los resultados, es mucho más probable que de entre los niños escogidos, este no tenga anemia y es menos probable que se encuentre en un estado grave de anemia.

## Probabilidad condicional

Ahora vamos a escoger dos pares de eventos, uno será independiente y el otro no será independiente.

### Eventos no independientes:

-   A1. Seleccionar una mujer de la muestra que este embarazada.

-   A2. Seleccionar una mujer de la muestra que no este embarazada.

Comprobamos que estos son no independientes.

Probabilidad del evento A1.

```{r}
table(RECH5$is_embarazada)
```

```{r}
A1 <-nrow(filter(RECH5, is_embarazada == "no embarazada"))/nrow(RECH5)
A1
```

Probabilidad del evento A2.

```{r}
A2 <-nrow(filter(RECH5, is_embarazada == "embarazada"))/nrow(RECH5)
A2
```

Vamos a probar que ambos eventos no son independientes, comprobando que son mutuamente excluyentes.

Probabilidad que ocurra A1 y A2.

```{r}
'A1_&_A2' <- nrow(filter(RECH5, is_embarazada == "embarazada" & is_embarazada == "no embarazada"))
`A1_&_A2`
```

Vemos que la intersección de ambos elementos es igual a cero. Al no haber intersección entre ambos eventos, se puede decir que son eventos no independientes, no cumpliendo la siguiente demostración:

$$
P(A1 \cap A2) = P(A1)*P(A2)\\ P(A1)>0 \\ P(A2) >0
$$

Dado que ambos eventos son mutuamente excluyentes y abarcan todo el espacio muestral de un experimento, estamos tratando con una partición. En este contexto, podemos aplicar el teorema de la probabilidad total para analizar la situación.

Teorema de la probabilidad total.

$$ P(B) = P(B \mid A1)*P(A1) + P(B \mid A2)*P(A2) $$

Para aquello, vamos a tomar un evento que pueda ocurrir en ambos. Este será el evento B, que representará si la mujer seleccionada tiene como mayor nivel educativo alcanzado la secundaria.

Probabilidad de que ocurra B

```{r}
B <- sum(RECH5$nivel_educativo == "2.secundaria")/nrow(RECH5)
B
```

Vamos a comprobarlo.

Observación:

$$P(x \mid y)*P(y) = P(x \cap y)$$

```{r}
prob_b_dado_a1_x_prob_a1 <- sum(RECH5$nivel_educativo == "2.secundaria" & RECH5$is_embarazada == 1)/nrow(RECH5)

prob_b_dado_a2_x_prob_a2 <- sum(RECH5$nivel_educativo == "2.secundaria" & RECH5$is_embarazada == 0)/nrow(RECH5)

prob_total_b = prob_b_dado_a1_x_prob_a1 + prob_b_dado_a2_x_prob_a2

prob_total_b
B
```

También por ser una partición, también se puede comprobar el teorema de Bayes.

Teorema de Bayes.

$$
P(A \mid B) = \frac{P(B \mid A)*P(A)}{P(B)}
$$

Lo vamos a comprobar.

```{r}
prob_a1_dado_b <- prob_b_dado_a1_x_prob_a1/B

prob_a1_dado_b
```

Con esto, se puede concluir que la probabilidad de que la mujer escogida resulte embarazada dado que su máximo nivel educativo alcanzado es la secundaria es 0.02863548

```{r}
prob_a2_dado_b <- prob_b_dado_a2_x_prob_a2/B

prob_a2_dado_b
```

Se puede concluir que la probabilidad de que la mujer escogida resulte embarazada dado que su máximo nivel educativo alcanzado es la secundaria es 0.9713645

### Variables independientes:

-   B1. Seleccionar un niño que tenga anemia dado que vive en un lugar urbano.

-   B2. Seleccionar un niño que tenga anemia dado que vive en un lugar rural.

Vamos a comprobar que estos eventos son independientes.

Primero vamos a crear la tabla para obtener nuestros eventos

```{r}
niños_region <- merge(REC0111, select(REC44, anemia, cuestionario_individual_id), by = "cuestionario_individual_id")
```

Probabilidad del evento B1.

```{r}
niños_anemia_urbano <- filter(niños_region, tipo_de_residencia=="urbano" & anemia!="0.sin_anemia")
B1 <- (nrow(niños_anemia_urbano)/nrow(niños_region[niños_region$tipo_de_residencia=="urbano",]))
B1
```

Probabilidad del evento B2.

```{r}
niños_anemia_rural <- filter(niños_region, tipo_de_residencia=="rural" & anemia!="0.sin_anemia")
B2 <- (nrow(niños_anemia_rural)/nrow(niños_region[niños_region$tipo_de_residencia=="rural",]))
B2
```

Para comprobar que son independientes, vamos a comparar la intersección de eventos de forma manual con el producto de ambas probabilidades. Según la regla, para dos eventos independientes, el producto de sus probabilidades resulta ser igual a la intersección.

$$
P(B1 \cap B2) = P(B1)*P(B2)
$$

Intersección de los eventos obtenidas de forma manual.

```{r}
choose((3223+1232+14),1)*choose((1891+967+13),1)/(choose(13570,1)*choose(6385,1))
```

Producto de las probabilidades de ambos eventos.

```{r}
B1_interseccion_B2 <- B1*B2
B1_interseccion_B2
```

Como podemos ver, estos resultan ser iguales. Por ello, los dos eventos son independientes.

Dado que son independientes, se puede hacer las siguientes comprobaciones.

$$
P(B1 \mid B2) = B1
$$

```{r}
prob_B1_dado_B2 <- B1_interseccion_B2/B2
prob_B1_dado_B2

B1
```

$$
P(B2 \mid B1) = B2
$$

```{r}
#(B2 | B1) = (B2 int B1)/B1
prob_B2_dado_B1 <- B1_interseccion_B2/B1
prob_B2_dado_B1

B2
```

$$
P(B1 \cap B2^c) = P(B1)*P(B2^c)
$$

```{r}
prob_b1_int_b2c = choose((3223+1232+14),1)*(choose(3514,1))/(choose(13570,1)*choose(6385,1))

prob_b1_int_b2c

B1*(1-B2)
```

$$
P(B1^c \cap B2^c) = P(B1^c)*P(B2^c)
$$

```{r}
prob_b1c_int_b2c = choose((9101),1)*(choose((3514),1))/(choose(13570,1)*choose(6385,1))

prob_b1c_int_b2c

(1-B2)*(1-B1)
```

Pagina para hacer notación de diversas operaciones:

<https://rpruim.github.io/s341/S19/from-class/MathinRmd.html>

```{r}
table(niños_region$anemia,niños_region$tipo_de_residencia)
```

### Variables aleatorias discretas.

#### Nivel de anemia.

Vamos a tomar el siguiente evento (que vendrá a ser nuestro éxito):

**G**: Seleccionar a un estudiante con anemia cuyo nivel sea clasificado como grave.

```{r}
table(REC44$anemia)
```

```{r}

L <- 5114
M <- 2199
G <- 27

Total <- L + M + G

PL <- L / Total
PM <- M / Total
PG <- G / Total

cat("Probabilidad de anemia leve (PL):", PL, "\n")
cat("Probabilidad de anemia moderada (PM):", PM, "\n")
cat("Probabilidad de anemia grave (PG):", PG, "\n")
```

```{r}
PG
```

La probabilidad de ocurra nuestro éxito (G):

$$
P(p) = \frac{27}{7340}
$$

La probabilidad de ocurra nuestro fracaso:

$$
P(q) = 1- P(p) = \frac{7313}{7340}
$$

-   **Definimos nuestra variable aleatoria discreta:**

**X**: Número de niños observados hasta que uno tenga anemia grave.

-   **Vamos a utilizar el modelo geométrico:**

$$
X\sim G(p)
$$

-   **Definimos parámetros:**

**p**: Probabilidad que el niño tenga anemia grave.

Observemos un gráfico de distribución geométrica en torno a nuestro evento de interés **G:**

```{r}

p <- PG # Probabilidad de que un niño tenga anemia grave en el modelo geométrico

X <- 0:500


# Graficar la distribución geométrica
plot(X, dgeom(X, p), type = "h", lwd = 2, col = "blue",
     ylab = "P(X = x)", xlab = "Número de chicos a observar hasta que uno tenga anemia grave",
     main = "Distribución Geométrica",
     sub = paste("Probabilidad de que un niño tenga anemia grave (PG):", p))
```

-   **Validamos las propiedades de esperanza, varianza, desviación estándar y coeficiente de variación:**

```{r}
# Parámetros del problema
n <- Total # Tamaño de la muestra
PG <- G / Total # Probabilidad de que un niño tenga anemia grave en el modelo geométrico

# Cálculos teóricos para el modelo geométrico
mu_geom <- 1 / PG
variance_geom <- (1 - PG) / PG^2
sigma_geom <- sqrt(variance_geom)
cv_geom <- sigma_geom / mu_geom

# Mostrar resultados para el modelo geométrico
cat("Media teórica (modelo geométrico):", mu_geom, "\n")
cat("Varianza teórica (modelo geométrico):", variance_geom, "\n")
cat("Desviación estándar teórica (modelo geométrico):", sigma_geom, "\n")
cat("Coeficiente de variación teórico (modelo geométrico):", cv_geom, "\n")

# Cálculos prácticos (usando la función dgeom)
probabilities_geom <- dgeom(0:n, PG) # Ajuste para la función dgeom
sample_mean_geom <- sum(probabilities_geom * (1:n))
sample_variance_geom <- sum(probabilities_geom * (1:n - sample_mean_geom)^2)
sample_sd_geom <- sqrt(sample_variance_geom)
sample_cv_geom <- sample_sd_geom / sample_mean_geom

# Mostrar resultados prácticos para el modelo geométrico
cat("\nMedia práctica (modelo geométrico):", sample_mean_geom, "\n")
cat("Varianza práctica (modelo geométrico):", sample_variance_geom, "\n")
cat("Desviación estándar práctica (modelo geométrico):", sample_sd_geom, "\n")
cat("Coeficiente de variación práctico (modelo geométrico):", sample_cv_geom, "\n")

```

Los resultados teóricos y prácticos en el modelo geométrico coinciden, demostrando la eficacia del modelo para describir el número de niños observados hasta encontrar uno con anemia grave. La coherencia en estos indicadores estadísticos respalda la validez de la aproximación geométrica en este contexto.

#### Experimento.

Se quiere averiguar la probabilidad de que se necesite observar más de 100 niños o menos para encontrar uno con anemia grave.

```{r}
pgeom(100 - 1, p)
```

La probabilidad de encontrar a un niño en estado grave es de aproximadamente 0.31, lo que equivale a casi 1/3 de probabilidad.

### Nivel educativo

Tendremos en cuenta nuestro evento (que vendrá a ser nuestro éxito):

**S**: Seleccionar a una madre que participó en la encuesta y determinar si su nivel educativo máximo alcanzado es secundaria.

```{r}
table(RECH5$nivel_educativo)
```

```{r}

N <- 451
P <- 7357
S <- 23642
U <- 4918

Total_E <- N + P + S + U

PN <- N / Total_E
PP <- P / Total_E
PS <- S / Total_E
PU <- U / Total_E

verificacion_probabilidades_E <- PN + PP + PS + PU

cat("Probabilidad de no educación (PN):", PN, "\n")
cat("Probabilidad de educación primaria (PP):", PP, "\n")
cat("Probabilidad de educación secundaria (PS):", PS, "\n")
cat("Probabilidad de educación superior (PU):", PU, "\n")
```

La probabilidad de que ocurra el éxito (**S**):

$$
P(S) = \frac{23642}{36368}
$$

La probabilidad de que ocurra el fracaso:

$$
P(q) = 1 - P(p) = \frac{12726}{36368}
$$

-   **Definimos nuestra variable aleatoria discreta:**

**X**: Número de madres cuyo mayor nivel educativo alcanzado sea la secundaria en una determinada muestra.

-   **Vamos a utilizar el modelo hipergeométrico:**

$$
X \sim H(N,r,n)
$$

-   **Definimos parámetros:**

**N**: Representa el total de mujeres que participaron en la encuesta.

**r**: Indica el número de mujeres cuyo nivel educativo máximo es la secundaria.

**n**: Es el número de elementos que seleccionaremos de este conjunto total.

Observemos una gráfica de distribución hipergeométrica en torno a los parámetros descritos y a nuestro evento de interés **S** en una muestra de 100:

```{r}

n <- 100 # Tamaño de la muestra
r <- S # Número de mujeres con educación secundaria en la población
N <- Total_E # Tamaño total de la población

XX <- 0:100

# Graficar la distribución hipergeométrica
plot(XX, dhyper(0:n, r, (N - r), n), type = "h", lwd = 2, col = "blue",
     ylab = "P(X = x)", xlab = "Número de estudiantes con educación secundaria en una muestra de 100",
     main = "Distribución Hipergeométrica",
     sub = paste("Total de estudiantes con educación secundaria:", S))
```

-   **Validamos las propiedades de esperanza, varianza, desviación estándar y coeficiente de variación:**

```{r}

# Cálculos teóricos
mu <- n * r / N
variance <- (n * r * (N - r) * (N - n)) / (N^2 * (N - 1))
sigma <- sqrt(variance)
cv <- sigma / mu

cat("Media teórica:", mu, "\n")
cat("Varianza teórica:", variance, "\n")
cat("Desviación estándar teórica:", sigma, "\n")
cat("Coeficiente de variación teórico:", cv, "\n")

# Cálculos prácticos (usando la función dhyper)
probabilities <- dhyper(0:n, r, (N - r), n)
sample_mean <- sum(probabilities * (0:n))
sample_variance <- sum(probabilities * (0:n - sample_mean)^2)
sample_sd <- sqrt(sample_variance)
sample_cv <- sample_sd / sample_mean

cat("\nMedia práctica:", sample_mean, "\n")
cat("Varianza práctica:", sample_variance, "\n")
cat("Desviación estándar práctica:", sample_sd, "\n")
cat("Coeficiente de variación práctico:", sample_cv, "\n")
```

Los resultados teóricos y prácticos en el modelo hipergeométrico coinciden, demostrando la eficacia del modelo para describir el número de niños observados hasta encontrar uno con anemia grave. La coherencia en estos indicadores estadísticos respalda la validez de la aproximación hipergeométrica en este contexto.

```{r}

# Graficar la distribución hipergeométrica
plot(XX, dhyper(0:n, r, (N - r), n), type = "h", lwd = 2, col = "blue",
     ylab = "P(X = x)", xlab = "Número de estudiantes con educación secundaria en una muestra de 100",
     main = "Distribución Hipergeométrica",
     sub = paste("Total de estudiantes con educación secundaria:", SEC))


# Añadir líneas de referencia para la media y desviación estándar
abline(v = mu, col = "red", lty = 2, lwd = 2)
abline(v = c(mu - sigma, mu + sigma), col = "green", lty = 3, lwd = 2)

# Añadir leyenda
legend("topleft", legend = c("Probabilidades", "Media", "Media ± 1 Desviación Estándar"),
       col = c("blue", "red", "green"), lty = c(1, 2, 3), lwd = 2)

# Interpretación
cat("La línea roja representa la media teórica de la distribución hipergeométrica.\n")
cat("Las líneas verdes indican la media ± 1 desviación estándar.\n")
cat("Esto ayuda a visualizar la dispersión de la distribución.\n")
```

-   **Experimento**

Deseamos determinar la probabilidad de seleccionar al menos 50 mujeres cuyo nivel educativo máximo sea la secundaria de una muestra de 100 mujeres.

```{r}
phyper(50, r, N - r, n, lower.tail = F)
```

Dado el resultado, es altamente probable encontrar en esta muestra de tamaño reducido a más de 50 mujeres cuyo máximo nivel educativo fue la secundaria. Esto se debe a la alta probabilidad del evento **S** (0.65).

### Variables aleatorias continuas.

```{r}
table(RECH5$hemoglobina)
```

```{r}
mu <- mean(RECH5$hemoglobina_ajustada_latitud, na.rm=TRUE);
mu
sigma <- sd(RECH5$hemoglobina_ajustada_latitud, na.rm=TRUE);
sigma

hist(RECH5$hemoglobina_ajustada_latitud, breaks=50, freq=FALSE, main="Histograma de hemoglobina", xlab="Nivel de hemoglobina (g/dl)", col="green")
lines(density(RECH5$hemoglobina_ajustada_latitud, na.rm=TRUE), col="red", lwd=3)
curve(dnorm(x, mu,  sigma), lwd=2, col="blue", add=TRUE)
legend("topleft", c("curva observada", "curva (normal) teórica"), lty=1, lwd=2, col=c("red", "blue"), bty="n", cex=0.8)

hist(RECH5$hemoglobina_ajustada_latitud, breaks=50, freq=FALSE, main="Histograma de hemoglobina", xlab="Nivel de hemoglobina (g/dl)", col="green")
lines(density(RECH5$hemoglobina_ajustada_latitud, na.rm=TRUE), col="red", lwd=3)
curve(dnorm(x, 12.81,  1.11), lwd=2, col="blue", add=TRUE)
legend("topleft", c("curva observada", "curva (normal) teórica"), lty=1, lwd=2, col=c("red", "blue"), bty="n", cex=0.8)
```

Por la forma que tiene el histograma es semejante a una campana. Además que la media y mediana son cercanas. Con estas pruebas, podemos asemejar la variable del nivel de hemoglobina ajustada a un modelo normal.

$$ X \sim N(\mu,\sigma) $$

Parámetro $\mu$ : Es el valor de la media de la variable.

Parámetro $\sigma$ :

#### - Peso

```{r}
table(RECH5$peso)
```

```{r}
datos <- RECH5$peso

hist(RECH5$peso,breaks=50, freq=FALSE, main="Histograma de peso", xlab="Peso (kg)", col="green")
```

```{r}
mu <- mean(RECH5$peso, na.rm=TRUE);
mu
sigma <- sd(RECH5$peso, na.rm=TRUE);
sigma

hist(RECH5$peso, breaks=50, freq=FALSE, main="Histograma de peso", xlab="Peso (kg)", col="green")
lines(density(RECH5$peso, na.rm=TRUE), col="red", lwd=3)
curve(dnorm(x, mu,  sigma), lwd=2, col="blue", add=TRUE)
legend("topleft", c("curva observada", "curva (normal) teórica"), lty=1, lwd=2, col=c("red", "blue"), bty="n", cex=0.8)


hist(RECH5$peso, breaks=50, freq=FALSE, main="Histograma de peso", xlab="Peso (kg)", col="green")
lines(density(RECH5$peso, na.rm=TRUE), col="red", lwd=3)
curve(dnorm(x, 60.8,  12.5), lwd=2, col="blue", add=TRUE)
legend("topleft", c("curva observada", "curva (normal) teórica"), lty=1, lwd=2, col=c("red", "blue"), bty="n", cex=0.8)
```
